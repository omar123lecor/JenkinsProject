[0m10:51:27.884722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ce9f6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ceb84b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665cee2b740>]}


============================== 10:51:27.893261 | 6b2e9428-60a3-43e7-8bbf-c4340922ae20 ==============================
[0m10:51:27.893261 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:51:27.894471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:28.173472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ce6e1af0>]}
[0m10:51:28.225280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ce93bc20>]}
[0m10:51:28.227655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:51:28.318704 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:51:28.322155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:51:28.323117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665cce60260>]}
[0m10:51:29.288689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665cca9b7a0>]}
[0m10:51:29.350974 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:51:29.358551 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:51:29.402603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ccc5f290>]}
[0m10:51:29.403713 [info ] [MainThread]: Found 6 models, 429 macros
[0m10:51:29.404823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ccbc0cb0>]}
[0m10:51:29.407290 [info ] [MainThread]: 
[0m10:51:29.408778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:29.409708 [info ] [MainThread]: 
[0m10:51:29.410722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:29.415006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m10:51:29.572709 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m10:51:29.573769 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:51:29.574765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:31.122919 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.548 seconds
[0m10:51:31.125306 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m10:51:31.127594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m10:51:31.132633 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:51:31.133646 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m10:51:31.134451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:31.198369 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m10:51:31.199741 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:51:31.200726 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:51:31.522260 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.320 seconds
[0m10:51:31.524766 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m10:51:31.526277 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m10:51:31.531928 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.533376 [debug] [MainThread]: On master: BEGIN
[0m10:51:31.534458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:31.548326 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:51:31.549483 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.550479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:31.685956 [debug] [MainThread]: SQL status: SELECT 0 in 0.134 seconds
[0m10:51:31.688594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ccc60a70>]}
[0m10:51:31.689816 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:31.690999 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.691949 [debug] [MainThread]: On master: BEGIN
[0m10:51:31.693151 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:51:31.693981 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.694828 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.695742 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.696865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:31.697742 [debug] [MainThread]: On master: Close
[0m10:51:31.700623 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m10:51:31.701835 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m10:51:31.703073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m10:51:31.704003 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m10:51:31.710074 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m10:51:31.724414 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m10:51:31.751893 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m10:51:31.774508 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:51:31.775529 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m10:51:31.776473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:31.790573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:51:31.791843 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:51:31.792870 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    Product_ID AS product_id,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales;
  );
[0m10:51:31.794344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: FROM public.sales;
                          ^

[0m10:51:31.795216 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: ROLLBACK
[0m10:51:31.796379 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m10:51:31.805358 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 30: FROM public.sales;
                            ^
  compiled code at target/run/sales_dbt_project/models/staging/stg_orders.sql
[0m10:51:31.807925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2e9428-60a3-43e7-8bbf-c4340922ae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ccab1100>]}
[0m10:51:31.809320 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.10s]
[0m10:51:31.810568 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m10:51:31.811726 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 30: FROM public.sales;
                            ^
  compiled code at target/run/sales_dbt_project/models/staging/stg_orders.sql.
[0m10:51:31.814107 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m10:51:31.815555 [info ] [Thread-1 (]: 2 of 6 SKIP relation public.dim_customer ....................................... [[33mSKIP[0m]
[0m10:51:31.816482 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m10:51:31.817340 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m10:51:31.818275 [info ] [Thread-1 (]: 3 of 6 SKIP relation public.dim_date ........................................... [[33mSKIP[0m]
[0m10:51:31.819182 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m10:51:31.820074 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m10:51:31.820950 [info ] [Thread-1 (]: 4 of 6 SKIP relation public.dim_product ........................................ [[33mSKIP[0m]
[0m10:51:31.821948 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m10:51:31.822947 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m10:51:31.823802 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.dim_region ......................................... [[33mSKIP[0m]
[0m10:51:31.824778 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m10:51:31.826302 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m10:51:31.827519 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.fact_orders ........................................ [[33mSKIP[0m]
[0m10:51:31.828599 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m10:51:31.830484 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.831315 [debug] [MainThread]: On master: BEGIN
[0m10:51:31.832174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:31.847242 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:51:31.848660 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.849526 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:31.850472 [debug] [MainThread]: On master: COMMIT
[0m10:51:31.851693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:31.852543 [debug] [MainThread]: On master: Close
[0m10:51:31.853505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:31.854390 [debug] [MainThread]: Connection 'model.sales_dbt_project.stg_orders' was properly closed.
[0m10:51:31.855337 [info ] [MainThread]: 
[0m10:51:31.856433 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m10:51:31.858212 [debug] [MainThread]: Command end result
[0m10:51:31.893263 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:51:31.912468 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:51:31.921786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:51:31.922810 [info ] [MainThread]: 
[0m10:51:31.923824 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:31.924806 [info ] [MainThread]: 
[0m10:51:31.925811 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 30: FROM public.sales;
                            ^
  compiled code at target/run/sales_dbt_project/models/staging/stg_orders.sql
[0m10:51:31.926691 [info ] [MainThread]: 
[0m10:51:31.927648 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m10:51:31.948403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.223365, "process_in_blocks": "20712", "process_kernel_time": 0.93101, "process_mem_max_rss": "110040", "process_out_blocks": "1600", "process_user_time": 2.827695}
[0m10:51:31.949832 [debug] [MainThread]: Command `dbt run` failed at 10:51:31.949728 after 4.22 seconds
[0m10:51:31.950773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ceb0aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665cca63b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665ccca59a0>]}
[0m10:51:31.951845 [debug] [MainThread]: Flushing usage events
[0m10:51:32.698684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:07.073423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c7645a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c76336420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c7634d520>]}


============================== 10:54:07.079084 | 1f103baa-62c6-458f-a637-ae84b00b7e0d ==============================
[0m10:54:07.079084 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:54:07.080434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:54:07.294904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c74762e70>]}
[0m10:54:07.348526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c764835c0>]}
[0m10:54:07.350658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:54:07.440678 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:54:08.078765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:54:08.080424 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/staging/stg_orders.sql
[0m10:54:08.294484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c742b6660>]}
[0m10:54:08.353064 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:54:08.360896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:54:08.397135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c7428a990>]}
[0m10:54:08.398359 [info ] [MainThread]: Found 6 models, 429 macros
[0m10:54:08.399344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c742b10a0>]}
[0m10:54:08.401959 [info ] [MainThread]: 
[0m10:54:08.403628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:08.404829 [info ] [MainThread]: 
[0m10:54:08.406065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:08.410477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m10:54:08.510029 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m10:54:08.511133 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:54:08.511952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:08.576149 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m10:54:08.578109 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m10:54:08.580239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m10:54:08.585187 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:54:08.586431 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m10:54:08.587414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:08.601038 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:54:08.602578 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:54:08.603458 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:54:08.608073 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:54:08.610203 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m10:54:08.611371 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m10:54:08.616299 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:08.617267 [debug] [MainThread]: On master: BEGIN
[0m10:54:08.618103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:08.624464 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:08.625579 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:08.626522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:08.630801 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:54:08.632624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c74362870>]}
[0m10:54:08.633583 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:08.634511 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:08.635244 [debug] [MainThread]: On master: BEGIN
[0m10:54:08.636356 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:54:08.637147 [debug] [MainThread]: On master: COMMIT
[0m10:54:08.637950 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:08.638650 [debug] [MainThread]: On master: COMMIT
[0m10:54:08.639595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:08.640463 [debug] [MainThread]: On master: Close
[0m10:54:08.643065 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m10:54:08.644011 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m10:54:08.645014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m10:54:08.645917 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m10:54:08.652537 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m10:54:08.659850 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m10:54:08.688121 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m10:54:08.695671 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:08.696656 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m10:54:08.697468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:08.713407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:54:08.714522 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:08.715313 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    Product_ID AS product_id,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m10:54:08.897766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.181 seconds
[0m10:54:08.904395 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:08.905477 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:54:08.925337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m10:54:08.939135 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:54:08.940512 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:08.941320 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:54:08.942914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:08.948172 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m10:54:08.953185 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:08.954070 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m10:54:08.988503 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m10:54:08.991784 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m10:54:08.994655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c77c32300>]}
[0m10:54:08.996295 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.35s]
[0m10:54:08.997674 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m10:54:08.999386 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m10:54:09.000474 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m10:54:09.001582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m10:54:09.002782 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m10:54:09.005971 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m10:54:09.017190 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m10:54:09.020423 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m10:54:09.031349 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:09.032292 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m10:54:09.033164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:09.039705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:54:09.041155 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:09.042029 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders";
  );
[0m10:54:09.043307 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 11: FROM "sales_warehouse"."public"."stg_orders";
                                                     ^

[0m10:54:09.044165 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: ROLLBACK
[0m10:54:09.045241 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m10:54:09.053571 [debug] [Thread-1 (]: Database Error in model dim_customer (models/dimensions/dim_customer.sql)
  syntax error at or near ";"
  LINE 11: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_customer.sql
[0m10:54:09.054826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c71459940>]}
[0m10:54:09.056068 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model public.dim_customer ....................... [[31mERROR[0m in 0.05s]
[0m10:54:09.057203 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m10:54:09.058246 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m10:54:09.058715 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/dimensions/dim_customer.sql)
  syntax error at or near ";"
  LINE 11: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_customer.sql.
[0m10:54:09.059453 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m10:54:09.075123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m10:54:09.076103 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m10:54:09.079093 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m10:54:09.086122 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m10:54:09.089135 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m10:54:09.096309 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:09.097280 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m10:54:09.098150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:09.105047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:54:09.106412 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:09.107220 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL;
  );
[0m10:54:09.108323 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: WHERE order_date IS NOT NULL;
                                     ^

[0m10:54:09.109093 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: ROLLBACK
[0m10:54:09.110028 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m10:54:09.112232 [debug] [Thread-1 (]: Database Error in model dim_date (models/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 14: WHERE order_date IS NOT NULL;
                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_date.sql
[0m10:54:09.113193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c703939b0>]}
[0m10:54:09.114329 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model public.dim_date ........................... [[31mERROR[0m in 0.04s]
[0m10:54:09.115389 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m10:54:09.116252 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m10:54:09.116625 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 14: WHERE order_date IS NOT NULL;
                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_date.sql.
[0m10:54:09.117364 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m10:54:09.119309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m10:54:09.120159 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m10:54:09.122911 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m10:54:09.130215 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m10:54:09.134762 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m10:54:09.142511 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:09.143615 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m10:54:09.144494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:09.150922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:54:09.152037 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:09.152911 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_id,
    product_name,
    category,
    sub_category
FROM "sales_warehouse"."public"."stg_orders";
  );
[0m10:54:09.154039 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12: FROM "sales_warehouse"."public"."stg_orders";
                                                     ^

[0m10:54:09.154959 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: ROLLBACK
[0m10:54:09.155889 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m10:54:09.158029 [debug] [Thread-1 (]: Database Error in model dim_product (models/dimensions/dim_product.sql)
  syntax error at or near ";"
  LINE 12: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m10:54:09.158952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c703813a0>]}
[0m10:54:09.159997 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model public.dim_product ........................ [[31mERROR[0m in 0.04s]
[0m10:54:09.161100 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m10:54:09.168624 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m10:54:09.169275 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/dimensions/dim_product.sql)
  syntax error at or near ";"
  LINE 12: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql.
[0m10:54:09.170186 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m10:54:09.171914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m10:54:09.172687 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m10:54:09.175424 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m10:54:09.182551 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m10:54:09.185522 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m10:54:09.192752 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:09.193646 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m10:54:09.194483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:09.201308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:54:09.202518 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:09.203481 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders";
  );
[0m10:54:09.204795 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 13: FROM "sales_warehouse"."public"."stg_orders";
                                                     ^

[0m10:54:09.205677 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: ROLLBACK
[0m10:54:09.206810 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m10:54:09.209032 [debug] [Thread-1 (]: Database Error in model dim_region (models/dimensions/dim_region.sql)
  syntax error at or near ";"
  LINE 13: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_region.sql
[0m10:54:09.210043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f103baa-62c6-458f-a637-ae84b00b7e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c714faf60>]}
[0m10:54:09.211197 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model public.dim_region ......................... [[31mERROR[0m in 0.04s]
[0m10:54:09.212300 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m10:54:09.213381 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_region' to be skipped because of status 'error'.  Reason: Database Error in model dim_region (models/dimensions/dim_region.sql)
  syntax error at or near ";"
  LINE 13: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_region.sql.
[0m10:54:09.214854 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m10:54:09.215762 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.fact_orders ........................................ [[33mSKIP[0m]
[0m10:54:09.216745 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m10:54:09.218618 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:09.219590 [debug] [MainThread]: On master: BEGIN
[0m10:54:09.220456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:09.227157 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:54:09.228341 [debug] [MainThread]: On master: COMMIT
[0m10:54:09.229377 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:09.230314 [debug] [MainThread]: On master: COMMIT
[0m10:54:09.231454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:09.232244 [debug] [MainThread]: On master: Close
[0m10:54:09.233178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:09.233950 [debug] [MainThread]: Connection 'model.sales_dbt_project.dim_region' was properly closed.
[0m10:54:09.234799 [info ] [MainThread]: 
[0m10:54:09.235690 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m10:54:09.237417 [debug] [MainThread]: Command end result
[0m10:54:09.267531 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:54:09.272838 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:54:09.282420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:54:09.283473 [info ] [MainThread]: 
[0m10:54:09.284454 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m10:54:09.285368 [info ] [MainThread]: 
[0m10:54:09.286287 [error] [MainThread]:   Database Error in model dim_customer (models/dimensions/dim_customer.sql)
  syntax error at or near ";"
  LINE 11: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_customer.sql
[0m10:54:09.287367 [info ] [MainThread]: 
[0m10:54:09.288561 [error] [MainThread]:   Database Error in model dim_date (models/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 14: WHERE order_date IS NOT NULL;
                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_date.sql
[0m10:54:09.289647 [info ] [MainThread]: 
[0m10:54:09.290734 [error] [MainThread]:   Database Error in model dim_product (models/dimensions/dim_product.sql)
  syntax error at or near ";"
  LINE 12: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m10:54:09.291687 [info ] [MainThread]: 
[0m10:54:09.292722 [error] [MainThread]:   Database Error in model dim_region (models/dimensions/dim_region.sql)
  syntax error at or near ";"
  LINE 13: FROM "sales_warehouse"."public"."stg_orders";
                                                       ^
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_region.sql
[0m10:54:09.293738 [info ] [MainThread]: 
[0m10:54:09.294693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=1 TOTAL=6
[0m10:54:09.297635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.360079, "process_in_blocks": "102192", "process_kernel_time": 0.989918, "process_mem_max_rss": "109776", "process_out_blocks": "0", "process_user_time": 2.636012}
[0m10:54:09.298688 [debug] [MainThread]: Command `dbt run` failed at 10:54:09.298585 after 2.36 seconds
[0m10:54:09.299565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c76336420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c7634d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784c7478a720>]}
[0m10:54:09.300355 [debug] [MainThread]: Flushing usage events
[0m10:54:10.140893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:43.071964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca7b2fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca77ecc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca7b2dca0>]}


============================== 10:54:43.076983 | 96f94ecc-9b4c-4b02-a882-8a8985950122 ==============================
[0m10:54:43.076983 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:54:43.078242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:43.232119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca7967da0>]}
[0m10:54:43.284880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca764f740>]}
[0m10:54:43.286418 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:54:43.419254 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:54:43.586025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:54:43.587428 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_customer.sql
[0m10:54:43.588487 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_date.sql
[0m10:54:43.589537 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_region.sql
[0m10:54:43.590426 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_product.sql
[0m10:54:43.857390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca595fa40>]}
[0m10:54:43.996416 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:54:44.003734 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:54:44.026080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca59ef1d0>]}
[0m10:54:44.027171 [info ] [MainThread]: Found 6 models, 429 macros
[0m10:54:44.028242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca595fb90>]}
[0m10:54:44.030617 [info ] [MainThread]: 
[0m10:54:44.031884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:44.033035 [info ] [MainThread]: 
[0m10:54:44.034305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:44.038954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m10:54:44.079651 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m10:54:44.081079 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:54:44.081902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:44.122640 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m10:54:44.125033 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m10:54:44.127770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m10:54:44.133732 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:54:44.134604 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m10:54:44.135276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:44.151584 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:54:44.152677 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:54:44.153563 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:54:44.156939 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m10:54:44.158522 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m10:54:44.159524 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m10:54:44.165742 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.166772 [debug] [MainThread]: On master: BEGIN
[0m10:54:44.167537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:44.174088 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:44.175492 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.176372 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:44.180671 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m10:54:44.183186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca59a0e30>]}
[0m10:54:44.184099 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:44.185073 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.185879 [debug] [MainThread]: On master: BEGIN
[0m10:54:44.186974 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:54:44.187873 [debug] [MainThread]: On master: COMMIT
[0m10:54:44.188639 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.189438 [debug] [MainThread]: On master: COMMIT
[0m10:54:44.190279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:44.191148 [debug] [MainThread]: On master: Close
[0m10:54:44.193689 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m10:54:44.194828 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m10:54:44.195969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m10:54:44.196793 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m10:54:44.202252 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m10:54:44.209685 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m10:54:44.236398 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m10:54:44.244517 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.245406 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m10:54:44.246237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.259214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:54:44.260392 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.261254 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    Product_ID AS product_id,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m10:54:44.265242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:44.271250 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.272188 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:54:44.273428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:44.276190 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.277144 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:54:44.278267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:44.290968 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:54:44.292286 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.293768 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:54:44.295479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:44.300801 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m10:54:44.306285 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:54:44.307234 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m10:54:44.396130 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.088 seconds
[0m10:54:44.400397 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m10:54:44.402863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca939e690>]}
[0m10:54:44.404300 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m10:54:44.405681 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m10:54:44.407485 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m10:54:44.408606 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m10:54:44.409822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m10:54:44.410764 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m10:54:44.413773 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m10:54:44.420694 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m10:54:44.423567 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m10:54:44.431004 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:44.431989 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m10:54:44.432928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.439816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:54:44.441014 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:44.441945 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:54:44.459621 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m10:54:44.463180 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:44.464252 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:54:44.465885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:44.467900 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m10:54:44.469192 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:44.470278 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m10:54:44.471862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:44.475403 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m10:54:44.476562 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:54:44.477362 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m10:54:44.478516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:44.480148 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m10:54:44.481786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc7128da30>]}
[0m10:54:44.482870 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:54:44.483991 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m10:54:44.484953 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m10:54:44.485861 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m10:54:44.486873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m10:54:44.487665 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m10:54:44.490905 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m10:54:44.497998 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m10:54:44.501219 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m10:54:44.508429 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:44.509378 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m10:54:44.510199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.516574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:54:44.517712 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:44.518664 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m10:54:44.524574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:54:44.527637 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:44.528444 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:54:44.529526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:44.531233 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m10:54:44.532136 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:44.533040 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m10:54:44.534572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:44.536883 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m10:54:44.538039 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:54:44.538867 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m10:54:44.539944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:44.541816 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m10:54:44.542841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc72c05d60>]}
[0m10:54:44.543951 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.06s]
[0m10:54:44.545111 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m10:54:44.545943 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m10:54:44.546873 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m10:54:44.547874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m10:54:44.548648 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m10:54:44.551113 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m10:54:44.558227 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m10:54:44.561310 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m10:54:44.567920 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:44.569096 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m10:54:44.569996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.576628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:54:44.577805 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:44.578662 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_id,
    product_name,
    category,
    sub_category
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:54:44.581057 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:54:44.583765 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:44.584704 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m10:54:44.586034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:44.587814 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m10:54:44.588589 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:44.589282 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m10:54:44.590617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:44.592874 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m10:54:44.593934 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:54:44.594676 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m10:54:44.595674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:44.597159 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m10:54:44.598101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc712a39b0>]}
[0m10:54:44.599195 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.05s]
[0m10:54:44.600655 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m10:54:44.601763 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m10:54:44.602701 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m10:54:44.603689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m10:54:44.604609 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m10:54:44.607234 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m10:54:44.614712 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m10:54:44.618247 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m10:54:44.625834 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:44.626937 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m10:54:44.627837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.635118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:54:44.636331 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:44.637301 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:54:44.640095 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:54:44.644544 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:44.645646 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m10:54:44.646974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:54:44.648703 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m10:54:44.649593 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:44.650550 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m10:54:44.652172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:54:44.654676 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m10:54:44.655811 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:54:44.656644 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m10:54:44.657874 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:54:44.659610 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m10:54:44.660708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfc712c8860>]}
[0m10:54:44.661906 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m10:54:44.663243 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m10:54:44.664959 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m10:54:44.666007 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m10:54:44.667031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m10:54:44.668003 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m10:54:44.671381 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m10:54:44.677983 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m10:54:44.681408 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m10:54:44.688679 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:54:44.689783 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m10:54:44.690715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:44.707983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:54:44.709232 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:54:44.710172 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_id,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_id = p.product_id
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region = r.region
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id;
  );
[0m10:54:44.711284 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ...arehouse"."public"."dim_date" d ON o.order_date = d.date_id;
                                                                       ^

[0m10:54:44.712079 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: ROLLBACK
[0m10:54:44.713098 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m10:54:44.716600 [debug] [Thread-1 (]: Database Error in model fact_orders (models/fact_orders.sql)
  syntax error at or near ";"
  LINE 21: ...arehouse"."public"."dim_date" d ON o.order_date = d.date_id;
                                                                         ^
  compiled code at target/run/sales_dbt_project/models/fact_orders.sql
[0m10:54:44.717635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96f94ecc-9b4c-4b02-a882-8a8985950122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca5a38440>]}
[0m10:54:44.718671 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model public.fact_orders ........................ [[31mERROR[0m in 0.05s]
[0m10:54:44.719831 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m10:54:44.720828 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/fact_orders.sql)
  syntax error at or near ";"
  LINE 21: ...arehouse"."public"."dim_date" d ON o.order_date = d.date_id;
                                                                         ^
  compiled code at target/run/sales_dbt_project/models/fact_orders.sql.
[0m10:54:44.723393 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.724316 [debug] [MainThread]: On master: BEGIN
[0m10:54:44.725201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:44.731718 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:54:44.732727 [debug] [MainThread]: On master: COMMIT
[0m10:54:44.733490 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:44.734243 [debug] [MainThread]: On master: COMMIT
[0m10:54:44.735130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:54:44.735996 [debug] [MainThread]: On master: Close
[0m10:54:44.737014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:44.737765 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m10:54:44.738620 [info ] [MainThread]: 
[0m10:54:44.739827 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m10:54:44.741889 [debug] [MainThread]: Command end result
[0m10:54:44.779480 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:54:44.784712 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:54:44.793183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:54:44.794014 [info ] [MainThread]: 
[0m10:54:44.795014 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:54:44.795872 [info ] [MainThread]: 
[0m10:54:44.796935 [error] [MainThread]:   Database Error in model fact_orders (models/fact_orders.sql)
  syntax error at or near ";"
  LINE 21: ...arehouse"."public"."dim_date" d ON o.order_date = d.date_id;
                                                                         ^
  compiled code at target/run/sales_dbt_project/models/fact_orders.sql
[0m10:54:44.797871 [info ] [MainThread]: 
[0m10:54:44.798773 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m10:54:44.800378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8898591, "process_in_blocks": "0", "process_kernel_time": 0.545995, "process_mem_max_rss": "110484", "process_out_blocks": "0", "process_user_time": 1.974321}
[0m10:54:44.801401 [debug] [MainThread]: Command `dbt run` failed at 10:54:44.801281 after 1.89 seconds
[0m10:54:44.802450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca79b3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca82aff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfca771c4d0>]}
[0m10:54:44.803507 [debug] [MainThread]: Flushing usage events
[0m10:54:45.484601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:20.865188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11c727fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11cd88890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11c753c80>]}


============================== 10:57:20.880527 | 0dade60a-0f69-44ff-908d-351e543b6d1b ==============================
[0m10:57:20.880527 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:57:20.881647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:21.099573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11dfbb2f0>]}
[0m10:57:21.151897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11cb969c0>]}
[0m10:57:21.154751 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:57:21.246321 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:57:21.456457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:21.458445 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/fact_orders.sql
[0m10:57:21.672464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11a8c0980>]}
[0m10:57:21.730475 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:57:21.943490 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:57:21.980336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11a5c6c30>]}
[0m10:57:21.981409 [info ] [MainThread]: Found 6 models, 429 macros
[0m10:57:21.982420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11a5e34d0>]}
[0m10:57:21.984775 [info ] [MainThread]: 
[0m10:57:21.985831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:21.986751 [info ] [MainThread]: 
[0m10:57:21.987821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:21.993643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m10:57:22.058958 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m10:57:22.060104 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:57:22.060884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:22.094065 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m10:57:22.096248 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m10:57:22.098408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m10:57:22.103376 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:57:22.104258 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m10:57:22.104964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:22.111870 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:57:22.113012 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m10:57:22.113806 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:57:22.118191 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:57:22.120001 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m10:57:22.121003 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m10:57:22.126339 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.127256 [debug] [MainThread]: On master: BEGIN
[0m10:57:22.128067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:22.144749 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:57:22.145865 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.146770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:22.173932 [debug] [MainThread]: SQL status: SELECT 5 in 0.026 seconds
[0m10:57:22.176948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11a732600>]}
[0m10:57:22.178175 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:22.179415 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.180262 [debug] [MainThread]: On master: BEGIN
[0m10:57:22.181348 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:22.182155 [debug] [MainThread]: On master: COMMIT
[0m10:57:22.182896 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.183639 [debug] [MainThread]: On master: COMMIT
[0m10:57:22.184649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:22.185517 [debug] [MainThread]: On master: Close
[0m10:57:22.188081 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m10:57:22.189221 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m10:57:22.190294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m10:57:22.191122 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m10:57:22.198403 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m10:57:22.205501 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m10:57:22.231970 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m10:57:22.239920 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.241193 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m10:57:22.242026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.254679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:57:22.255728 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.256711 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    Product_ID AS product_id,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m10:57:22.262067 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:57:22.268177 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.269031 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:57:22.270917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:22.273880 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.274897 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:57:22.276465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.289209 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:57:22.290721 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.291514 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m10:57:22.293305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.298668 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m10:57:22.304184 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m10:57:22.305346 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m10:57:22.318803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m10:57:22.321558 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m10:57:22.323786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11a5dba70>]}
[0m10:57:22.325039 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m10:57:22.326091 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m10:57:22.327582 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m10:57:22.328539 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m10:57:22.329598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m10:57:22.330429 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m10:57:22.333040 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m10:57:22.340359 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m10:57:22.343706 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m10:57:22.350850 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:57:22.351695 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m10:57:22.352489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.359423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:57:22.360344 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:57:22.361151 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:57:22.364495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:57:22.367475 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:57:22.368470 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:57:22.369748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.371492 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m10:57:22.372256 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:57:22.373013 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m10:57:22.374367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.378195 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m10:57:22.379142 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m10:57:22.380049 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m10:57:22.381498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:22.383148 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m10:57:22.384116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0d5e11c10>]}
[0m10:57:22.385169 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m10:57:22.386399 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m10:57:22.387252 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m10:57:22.388170 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m10:57:22.389176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m10:57:22.389963 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m10:57:22.392367 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m10:57:22.399462 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m10:57:22.402664 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m10:57:22.409443 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:57:22.410339 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m10:57:22.411135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.417566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:57:22.418563 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:57:22.419488 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m10:57:22.422105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:57:22.424969 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:57:22.425781 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:57:22.427051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.428698 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m10:57:22.429582 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:57:22.430396 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m10:57:22.431798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.434020 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m10:57:22.435082 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m10:57:22.435860 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m10:57:22.436892 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:57:22.438983 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m10:57:22.440086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0d5e12a20>]}
[0m10:57:22.441089 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m10:57:22.442391 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m10:57:22.443302 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m10:57:22.444148 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m10:57:22.445095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m10:57:22.445867 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m10:57:22.448338 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m10:57:22.455368 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m10:57:22.458320 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m10:57:22.464980 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:57:22.465898 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m10:57:22.466697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.480560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:57:22.481597 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:57:22.482507 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_id,
    product_name,
    category,
    sub_category
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:57:22.484682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:57:22.487975 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:57:22.488791 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m10:57:22.489989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.491647 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m10:57:22.492628 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:57:22.493663 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m10:57:22.495149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.497266 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m10:57:22.498277 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m10:57:22.499126 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m10:57:22.500161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:57:22.501581 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m10:57:22.502568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0d77b3ad0>]}
[0m10:57:22.503842 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m10:57:22.504979 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m10:57:22.505844 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m10:57:22.506778 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m10:57:22.507851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m10:57:22.508647 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m10:57:22.511235 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m10:57:22.518275 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m10:57:22.521364 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m10:57:22.528425 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:57:22.529372 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m10:57:22.530234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.536715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:57:22.537704 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:57:22.538534 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m10:57:22.540843 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:57:22.544267 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:57:22.545226 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m10:57:22.546280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.547825 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m10:57:22.548707 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:57:22.549655 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m10:57:22.551192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.554432 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m10:57:22.555824 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m10:57:22.556924 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m10:57:22.558011 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:57:22.559602 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m10:57:22.560948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0d5e52150>]}
[0m10:57:22.562250 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m10:57:22.563314 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m10:57:22.564614 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m10:57:22.565526 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m10:57:22.566511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m10:57:22.567351 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m10:57:22.570514 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m10:57:22.576517 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m10:57:22.579826 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m10:57:22.594260 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:57:22.595415 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m10:57:22.596370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:22.602931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:57:22.604047 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:57:22.604860 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_id,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_id = p.product_id
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region = r.region
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m10:57:22.620034 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m10:57:22.623580 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:57:22.624469 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m10:57:22.625737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:22.627532 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m10:57:22.628273 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:57:22.628948 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m10:57:22.630966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:22.633230 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m10:57:22.634313 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m10:57:22.635084 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m10:57:22.636081 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:57:22.637622 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m10:57:22.638562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dade60a-0f69-44ff-908d-351e543b6d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b0d5e52630>]}
[0m10:57:22.639624 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.07s]
[0m10:57:22.640863 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m10:57:22.642700 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.643526 [debug] [MainThread]: On master: BEGIN
[0m10:57:22.644354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:22.650299 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:57:22.651309 [debug] [MainThread]: On master: COMMIT
[0m10:57:22.652208 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:22.652974 [debug] [MainThread]: On master: COMMIT
[0m10:57:22.653915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:22.654758 [debug] [MainThread]: On master: Close
[0m10:57:22.655702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:22.656581 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m10:57:22.657563 [info ] [MainThread]: 
[0m10:57:22.658504 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m10:57:22.660525 [debug] [MainThread]: Command end result
[0m10:57:22.691252 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:57:22.696217 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:57:22.705732 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:57:22.706901 [info ] [MainThread]: 
[0m10:57:22.707987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:22.708996 [info ] [MainThread]: 
[0m10:57:22.709932 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:57:22.713035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0681164, "process_in_blocks": "101824", "process_kernel_time": 0.692175, "process_mem_max_rss": "109276", "process_out_blocks": "0", "process_user_time": 2.164789}
[0m10:57:22.714395 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:22.714221 after 2.07 seconds
[0m10:57:22.715445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11c5a7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11cb97530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b11c6b21b0>]}
[0m10:57:22.716434 [debug] [MainThread]: Flushing usage events
[0m10:57:23.497997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:00.722080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86625c5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8662290500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8662b1d4c0>]}


============================== 14:55:00.728646 | d1729aee-d427-403b-b597-3132d4817198 ==============================
[0m14:55:00.728646 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:55:00.730057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:01.017738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8663de7560>]}
[0m14:55:01.071752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8661fbd7c0>]}
[0m14:55:01.074353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:55:01.171543 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:55:01.485329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:55:01.487498 [debug] [MainThread]: Partial parsing: added file: sales_dbt_project://models/schema.yml
[0m14:55:01.726275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86604f9280>]}
[0m14:55:01.802119 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m14:55:01.808544 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m14:55:01.859091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866046bdd0>]}
[0m14:55:01.860462 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m14:55:01.861375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8660721790>]}
[0m14:55:01.864971 [info ] [MainThread]: 
[0m14:55:01.866178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:01.867148 [info ] [MainThread]: 
[0m14:55:01.868153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:01.872218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m14:55:02.215771 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m14:55:02.217634 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:55:02.218586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:02.553940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.335 seconds
[0m14:55:02.556204 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m14:55:02.558451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m14:55:02.563449 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m14:55:02.564510 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m14:55:02.565662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.573231 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:55:02.574233 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m14:55:02.575173 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:55:02.639607 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.063 seconds
[0m14:55:02.642124 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m14:55:02.643497 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m14:55:02.649862 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:02.650879 [debug] [MainThread]: On master: BEGIN
[0m14:55:02.651844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:02.659349 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:55:02.660405 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:02.661236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:02.691021 [debug] [MainThread]: SQL status: SELECT 10 in 0.029 seconds
[0m14:55:02.695483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866040d580>]}
[0m14:55:02.696574 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:02.697642 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:02.698442 [debug] [MainThread]: On master: BEGIN
[0m14:55:02.699578 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:55:02.700425 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.701142 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:02.702014 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.717630 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m14:55:02.718773 [debug] [MainThread]: On master: Close
[0m14:55:02.721908 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m14:55:02.723388 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m14:55:02.724713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m14:55:02.725921 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m14:55:02.732379 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m14:55:02.775305 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m14:55:02.803169 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m14:55:02.811838 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.812850 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m14:55:02.813797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:02.822418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:55:02.823415 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.824111 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    Product_ID AS product_id,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m14:55:02.936991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.112 seconds
[0m14:55:02.944343 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.945988 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:55:02.950994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:55:02.954158 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.955551 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:55:02.957202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:02.970211 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m14:55:02.971728 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.972766 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m14:55:02.974812 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:02.981221 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m14:55:02.991784 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m14:55:02.992776 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m14:55:03.037519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.044 seconds
[0m14:55:03.040963 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m14:55:03.043764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8663de6630>]}
[0m14:55:03.045172 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m14:55:03.046444 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m14:55:03.048479 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m14:55:03.049669 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m14:55:03.050854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m14:55:03.051781 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m14:55:03.054629 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m14:55:03.061501 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m14:55:03.064552 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m14:55:03.072025 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m14:55:03.072801 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m14:55:03.073583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.093804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m14:55:03.095110 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m14:55:03.095954 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m14:55:03.099764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:55:03.102688 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m14:55:03.103552 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m14:55:03.104743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.106422 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m14:55:03.107490 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m14:55:03.108763 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m14:55:03.110787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.112946 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m14:55:03.114097 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m14:55:03.114878 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m14:55:03.116352 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:55:03.117892 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m14:55:03.118947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8661f42e70>]}
[0m14:55:03.120083 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:55:03.121116 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m14:55:03.121991 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m14:55:03.122936 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m14:55:03.123839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m14:55:03.124668 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m14:55:03.127384 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m14:55:03.135789 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m14:55:03.138822 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m14:55:03.146133 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m14:55:03.147174 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m14:55:03.147881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.164100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m14:55:03.165109 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m14:55:03.166010 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m14:55:03.170834 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:55:03.173846 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m14:55:03.175372 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:55:03.186729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m14:55:03.189223 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m14:55:03.190295 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m14:55:03.191324 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m14:55:03.193059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.195692 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m14:55:03.197234 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m14:55:03.198225 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m14:55:03.199557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:55:03.201309 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m14:55:03.202287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f54d280>]}
[0m14:55:03.203390 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:55:03.204415 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m14:55:03.205284 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m14:55:03.206175 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m14:55:03.207111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m14:55:03.207971 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m14:55:03.210380 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m14:55:03.222401 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m14:55:03.226602 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m14:55:03.239320 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m14:55:03.240276 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m14:55:03.241111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.248042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:55:03.249160 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m14:55:03.250059 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_id,
    product_name,
    category,
    sub_category
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m14:55:03.253592 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:55:03.256503 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m14:55:03.257388 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m14:55:03.258568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.260217 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m14:55:03.261029 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m14:55:03.261850 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m14:55:03.263502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.265638 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m14:55:03.266602 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m14:55:03.267568 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m14:55:03.268681 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:55:03.270272 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m14:55:03.271284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f570740>]}
[0m14:55:03.272468 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m14:55:03.273533 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m14:55:03.274339 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m14:55:03.275219 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m14:55:03.276023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m14:55:03.276839 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m14:55:03.279326 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m14:55:03.286090 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m14:55:03.289024 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m14:55:03.303586 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m14:55:03.304553 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m14:55:03.305315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.314234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:55:03.315246 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m14:55:03.316180 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m14:55:03.322780 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:55:03.325907 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m14:55:03.326674 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m14:55:03.327813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:55:03.329742 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m14:55:03.330514 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m14:55:03.331352 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m14:55:03.332938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.335072 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m14:55:03.336136 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m14:55:03.336922 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m14:55:03.337959 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:55:03.339713 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m14:55:03.340669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f54ed80>]}
[0m14:55:03.341659 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m14:55:03.342689 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m14:55:03.343901 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m14:55:03.345148 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m14:55:03.346036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m14:55:03.346743 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m14:55:03.352320 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m14:55:03.358314 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m14:55:03.361321 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m14:55:03.367810 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m14:55:03.368736 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m14:55:03.369568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.384385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:55:03.385526 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m14:55:03.386359 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_id,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_id = p.product_id
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region = r.region
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m14:55:03.391239 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:55:03.394186 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m14:55:03.395202 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m14:55:03.396602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:55:03.398325 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m14:55:03.399096 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m14:55:03.399901 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m14:55:03.401363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:55:03.403551 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m14:55:03.404555 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m14:55:03.405413 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m14:55:03.406415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:55:03.408159 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m14:55:03.409263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1729aee-d427-403b-b597-3132d4817198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f4f1790>]}
[0m14:55:03.410399 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m14:55:03.411627 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m14:55:03.413623 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:03.414603 [debug] [MainThread]: On master: BEGIN
[0m14:55:03.415376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:03.431938 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:55:03.433382 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.434142 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:03.434865 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.435851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:55:03.436667 [debug] [MainThread]: On master: Close
[0m14:55:03.437565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:03.438326 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m14:55:03.439250 [info ] [MainThread]: 
[0m14:55:03.439962 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m14:55:03.441772 [debug] [MainThread]: Command end result
[0m14:55:03.472388 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m14:55:03.477356 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m14:55:03.486889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m14:55:03.488013 [info ] [MainThread]: 
[0m14:55:03.488996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:03.489877 [info ] [MainThread]: 
[0m14:55:03.490788 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:55:03.494020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9381475, "process_in_blocks": "101512", "process_kernel_time": 2.192858, "process_mem_max_rss": "108644", "process_out_blocks": "0", "process_user_time": 2.521006}
[0m14:55:03.495980 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:03.495764 after 2.94 seconds
[0m14:55:03.496915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86624f7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86604c6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86620494f0>]}
[0m14:55:03.497798 [debug] [MainThread]: Flushing usage events
[0m14:55:04.665662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:34.168516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b480479a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4804df1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b480479a060>]}


============================== 14:58:34.186206 | acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a ==============================
[0m14:58:34.186206 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:58:34.187529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:34.454403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4802874c80>]}
[0m14:58:34.505983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48028fb5c0>]}
[0m14:58:34.508120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:58:34.598722 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:58:34.907112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:34.908546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:34.942762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b480292dc10>]}
[0m14:58:35.016517 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m14:58:35.035736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m14:58:35.123853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48021ff110>]}
[0m14:58:35.124914 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m14:58:35.126009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b480292da30>]}
[0m14:58:35.128864 [info ] [MainThread]: 
[0m14:58:35.130060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:35.131085 [info ] [MainThread]: 
[0m14:58:35.132499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:35.137376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m14:58:35.340796 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m14:58:35.342293 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m14:58:35.343333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:35.401512 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m14:58:35.402844 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m14:58:35.403839 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:58:35.412504 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:58:35.414773 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m14:58:35.416094 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m14:58:35.421802 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:35.422912 [debug] [MainThread]: On master: BEGIN
[0m14:58:35.424059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:35.430452 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:58:35.431525 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:35.432305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:35.437990 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m14:58:35.442010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acfb77c7-7f21-4df2-8ef3-2d9fc9cbd70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b480292d940>]}
[0m14:58:35.443434 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:35.444442 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:35.445117 [debug] [MainThread]: On master: BEGIN
[0m14:58:35.446207 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:58:35.447023 [debug] [MainThread]: On master: COMMIT
[0m14:58:35.447811 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:35.448648 [debug] [MainThread]: On master: COMMIT
[0m14:58:35.449583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:35.450352 [debug] [MainThread]: On master: Close
[0m14:58:35.453096 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m14:58:35.454053 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m14:58:35.455092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m14:58:35.456022 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m14:58:35.468374 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m14:58:35.480153 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m14:58:35.492298 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m14:58:35.503417 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m14:58:35.504409 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m14:58:35.505446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:35.523595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m14:58:35.524743 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m14:58:35.525506 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m14:58:36.070255 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.544 seconds
[0m14:58:36.075565 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m14:58:36.077285 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m14:58:36.078776 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.62s]
[0m14:58:36.082152 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m14:58:36.083380 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m14:58:36.084424 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_id ............................. [RUN]
[0m14:58:36.085588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816)
[0m14:58:36.086572 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m14:58:36.090753 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m14:58:36.098290 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m14:58:36.101813 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m14:58:36.110158 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m14:58:36.111597 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m14:58:36.112822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.119756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:58:36.120958 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m14:58:36.122048 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "sales_warehouse"."public"."dim_product"
where product_id is null



      
    ) dbt_internal_test
[0m14:58:36.137009 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m14:58:36.139315 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m14:58:36.140378 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: Close
[0m14:58:36.141729 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.06s]
[0m14:58:36.143012 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m14:58:36.143986 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m14:58:36.144814 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_postal_code ............................. [RUN]
[0m14:58:36.145858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816, now test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870)
[0m14:58:36.146676 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m14:58:36.150148 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m14:58:36.170018 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m14:58:36.172860 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m14:58:36.180313 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m14:58:36.181310 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: BEGIN
[0m14:58:36.182325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.251558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m14:58:36.252836 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m14:58:36.253806 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select postal_code
from "sales_warehouse"."public"."dim_region"
where postal_code is null



      
    ) dbt_internal_test
[0m14:58:36.257103 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:58:36.259355 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: ROLLBACK
[0m14:58:36.260711 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: Close
[0m14:58:36.261925 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_postal_code ................................... [[32mPASS[0m in 0.12s]
[0m14:58:36.263053 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m14:58:36.264017 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m14:58:36.264907 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m14:58:36.265947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m14:58:36.266969 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m14:58:36.270691 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m14:58:36.278336 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m14:58:36.280848 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m14:58:36.288822 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m14:58:36.289847 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m14:58:36.290791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.297592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:58:36.298831 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m14:58:36.299770 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m14:58:36.311660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:58:36.313843 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m14:58:36.314806 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m14:58:36.315825 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.05s]
[0m14:58:36.316976 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m14:58:36.317898 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m14:58:36.318786 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m14:58:36.319851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m14:58:36.320670 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m14:58:36.324057 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m14:58:36.331321 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m14:58:36.334072 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m14:58:36.341827 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m14:58:36.342830 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m14:58:36.343816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.350289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:58:36.351566 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m14:58:36.352486 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m14:58:36.358032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:58:36.360467 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m14:58:36.361501 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m14:58:36.362595 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.04s]
[0m14:58:36.363702 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m14:58:36.364599 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m14:58:36.365436 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m14:58:36.366440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m14:58:36.367281 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m14:58:36.370859 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m14:58:36.377954 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m14:58:36.380300 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m14:58:36.387554 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m14:58:36.388609 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m14:58:36.389592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.396684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:58:36.397805 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m14:58:36.398768 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m14:58:36.404512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:58:36.406806 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m14:58:36.408373 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m14:58:36.409542 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m14:58:36.410663 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m14:58:36.411626 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m14:58:36.412495 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m14:58:36.413459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m14:58:36.414309 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m14:58:36.419685 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m14:58:36.427898 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m14:58:36.430493 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m14:58:36.438547 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m14:58:36.439488 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m14:58:36.440303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.446836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:58:36.448043 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m14:58:36.449028 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:58:36.454378 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:58:36.456806 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m14:58:36.457837 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m14:58:36.458884 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m14:58:36.460118 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m14:58:36.461070 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m14:58:36.461902 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_id ............................... [RUN]
[0m14:58:36.462857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe)
[0m14:58:36.463723 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m14:58:36.469002 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m14:58:36.477413 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m14:58:36.480093 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m14:58:36.487923 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m14:58:36.488955 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m14:58:36.489799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.496080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:58:36.497224 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m14:58:36.498238 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:58:36.506542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:58:36.508853 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m14:58:36.510106 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: Close
[0m14:58:36.511363 [error] [Thread-1 (]: 8 of 10 FAIL 30 unique_dim_product_product_id .................................. [[31mFAIL 30[0m in 0.05s]
[0m14:58:36.512618 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m14:58:36.513605 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m14:58:36.514487 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_postal_code ............................... [RUN]
[0m14:58:36.515576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe, now test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638)
[0m14:58:36.516363 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m14:58:36.519843 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m14:58:36.526424 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m14:58:36.528728 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m14:58:36.536747 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m14:58:36.537741 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: BEGIN
[0m14:58:36.538615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.545165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:58:36.546282 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m14:58:36.547266 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    postal_code as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where postal_code is not null
group by postal_code
having count(*) > 1



      
    ) dbt_internal_test
[0m14:58:36.553220 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:58:36.555314 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: ROLLBACK
[0m14:58:36.556387 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: Close
[0m14:58:36.557488 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_dim_region_postal_code ................................... [[31mFAIL 1[0m in 0.04s]
[0m14:58:36.558757 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m14:58:36.559672 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m14:58:36.560489 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m14:58:36.561454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m14:58:36.562268 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m14:58:36.565873 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m14:58:36.572700 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m14:58:36.575425 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m14:58:36.583330 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m14:58:36.584324 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m14:58:36.585166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:36.592138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:58:36.593323 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m14:58:36.594273 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m14:58:36.858092 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.263 seconds
[0m14:58:36.860692 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m14:58:36.861739 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m14:58:36.862974 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 0.30s]
[0m14:58:36.864125 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m14:58:36.865996 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:36.877600 [debug] [MainThread]: On master: BEGIN
[0m14:58:36.878353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:36.895536 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m14:58:36.896858 [debug] [MainThread]: On master: COMMIT
[0m14:58:36.897924 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:36.898858 [debug] [MainThread]: On master: COMMIT
[0m14:58:36.899888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:36.900802 [debug] [MainThread]: On master: Close
[0m14:58:36.901975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:36.902895 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m14:58:36.903698 [info ] [MainThread]: 
[0m14:58:36.904570 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m14:58:36.906827 [debug] [MainThread]: Command end result
[0m14:58:36.936143 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m14:58:36.941287 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m14:58:36.950997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m14:58:36.951981 [info ] [MainThread]: 
[0m14:58:36.953212 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:58:36.954171 [info ] [MainThread]: 
[0m14:58:36.955263 [error] [MainThread]: [31mFailure in test unique_dim_product_product_id (models/schema.yml)[0m
[0m14:58:36.956263 [error] [MainThread]:   Got 30 results, configured to fail if != 0
[0m14:58:36.957145 [info ] [MainThread]: 
[0m14:58:36.958094 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_product_product_id.sql
[0m14:58:36.959014 [info ] [MainThread]: 
[0m14:58:36.959967 [error] [MainThread]: [31mFailure in test unique_dim_region_postal_code (models/schema.yml)[0m
[0m14:58:36.960903 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:58:36.961722 [info ] [MainThread]: 
[0m14:58:36.962686 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_region_postal_code.sql
[0m14:58:36.963596 [info ] [MainThread]: 
[0m14:58:36.964528 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m14:58:36.965358 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m14:58:36.966190 [info ] [MainThread]: 
[0m14:58:36.967038 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m14:58:36.967985 [info ] [MainThread]: 
[0m14:58:36.968986 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m14:58:36.972519 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8642755, "process_in_blocks": "103056", "process_kernel_time": 1.178499, "process_mem_max_rss": "109936", "process_out_blocks": "1600", "process_user_time": 2.44232}
[0m14:58:36.973822 [debug] [MainThread]: Command `dbt test` failed at 14:58:36.973686 after 2.87 seconds
[0m14:58:36.974815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4804d2d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48078fe900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b48078fe930>]}
[0m14:58:36.975655 [debug] [MainThread]: Flushing usage events
[0m14:58:37.949070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:10.763965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea9cc6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea9505d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea9cc75c0>]}


============================== 17:06:10.774389 | fbb4ce61-07fb-4546-8c54-94dfb88cbe05 ==============================
[0m17:06:10.774389 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:06:10.775942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:11.225022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea914e9c0>]}
[0m17:06:11.279585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708eab1d7c50>]}
[0m17:06:11.282485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:11.374969 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:06:11.788345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:06:11.790082 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/fact_orders.sql
[0m17:06:11.791106 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/staging/stg_orders.sql
[0m17:06:11.792147 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_product.sql
[0m17:06:12.166035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea75512e0>]}
[0m17:06:12.254544 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:06:12.269153 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:06:12.525982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea5452fc0>]}
[0m17:06:12.527259 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:06:12.528307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea925b770>]}
[0m17:06:12.531100 [info ] [MainThread]: 
[0m17:06:12.532213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:12.533195 [info ] [MainThread]: 
[0m17:06:12.534361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:12.539545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:06:12.831447 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:06:12.832798 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:06:12.833770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:13.082153 [debug] [ThreadPool]: SQL status: BEGIN in 0.248 seconds
[0m17:06:13.083579 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:06:13.084673 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:06:13.280709 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.195 seconds
[0m17:06:13.283439 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:06:13.285345 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:06:13.291915 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:13.302389 [debug] [MainThread]: On master: BEGIN
[0m17:06:13.303552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:13.331227 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:06:13.332570 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:13.333631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:13.360362 [debug] [MainThread]: SQL status: SELECT 10 in 0.026 seconds
[0m17:06:13.364818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb4ce61-07fb-4546-8c54-94dfb88cbe05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea74948f0>]}
[0m17:06:13.366179 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:13.367342 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:13.368315 [debug] [MainThread]: On master: BEGIN
[0m17:06:13.369821 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:06:13.370922 [debug] [MainThread]: On master: COMMIT
[0m17:06:13.371950 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:13.372728 [debug] [MainThread]: On master: COMMIT
[0m17:06:13.374153 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:06:13.374910 [debug] [MainThread]: On master: Close
[0m17:06:13.377805 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:06:13.378765 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:06:13.379726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:06:13.380460 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:06:13.393558 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:06:13.421057 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:06:13.432797 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:06:13.448184 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:06:13.449090 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:06:13.449958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.471251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:06:13.472563 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:06:13.473499 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:06:13.532223 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m17:06:13.537357 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:06:13.538806 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:06:13.540044 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.16s]
[0m17:06:13.541406 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:06:13.542320 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m17:06:13.543122 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_id ............................. [RUN]
[0m17:06:13.544114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816)
[0m17:06:13.544957 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m17:06:13.548592 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m17:06:13.562844 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m17:06:13.565634 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m17:06:13.596019 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m17:06:13.596935 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: BEGIN
[0m17:06:13.597750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.604237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:06:13.605248 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m17:06:13.606197 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "sales_warehouse"."public"."dim_product"
where product_id is null



      
    ) dbt_internal_test
[0m17:06:13.609590 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:06:13.611666 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: ROLLBACK
[0m17:06:13.612722 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816: Close
[0m17:06:13.613917 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_id ................................... [[32mPASS[0m in 0.07s]
[0m17:06:13.615110 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816
[0m17:06:13.616076 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:06:13.616934 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_postal_code ............................. [RUN]
[0m17:06:13.617878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_id.02b1f06816, now test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870)
[0m17:06:13.618676 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:06:13.623008 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:06:13.637628 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:06:13.639979 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:06:13.654920 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:06:13.655860 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: BEGIN
[0m17:06:13.656587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.676632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:06:13.678038 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:06:13.679461 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select postal_code
from "sales_warehouse"."public"."dim_region"
where postal_code is null



      
    ) dbt_internal_test
[0m17:06:13.683020 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:06:13.685061 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: ROLLBACK
[0m17:06:13.686446 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: Close
[0m17:06:13.687736 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_postal_code ................................... [[32mPASS[0m in 0.07s]
[0m17:06:13.688864 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:06:13.689689 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:06:13.690554 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:06:13.691477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:06:13.692298 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:06:13.695696 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:06:13.711106 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:06:13.713752 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:06:13.726900 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:06:13.727842 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:06:13.728590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.748280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:06:13.749819 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:06:13.750727 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:06:13.775309 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m17:06:13.778186 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:06:13.780158 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:06:13.781540 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.09s]
[0m17:06:13.782823 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:06:13.783831 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:06:13.784784 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:06:13.785928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:06:13.786871 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:06:13.791088 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:06:13.805015 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:06:13.807359 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:06:13.831080 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:06:13.832132 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:06:13.833022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.849793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:06:13.850854 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:06:13.851623 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:06:13.857080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:06:13.859016 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:06:13.860029 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:06:13.861009 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.08s]
[0m17:06:13.862201 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:06:13.863055 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:06:13.864022 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:06:13.865475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:06:13.866321 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:06:13.869811 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:06:13.885160 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:06:13.887503 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:06:13.910360 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:06:13.911409 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:06:13.912239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.919018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:06:13.920032 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:06:13.920878 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:06:13.926220 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:06:13.928103 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:06:13.929005 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:06:13.930049 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.06s]
[0m17:06:13.931270 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:06:13.932212 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:06:13.933044 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:06:13.934025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:06:13.934830 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:06:13.940246 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:06:13.955617 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:06:13.958032 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:06:13.973344 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:06:13.974281 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:06:13.975160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:13.982009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:06:13.983254 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:06:13.984174 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:13.989593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:06:13.991653 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:06:13.992875 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:06:13.994358 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.06s]
[0m17:06:13.995509 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:06:13.996451 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m17:06:13.997310 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_id ............................... [RUN]
[0m17:06:13.998276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe)
[0m17:06:13.999118 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m17:06:14.002835 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m17:06:14.017056 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m17:06:14.019455 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m17:06:14.032817 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m17:06:14.033998 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: BEGIN
[0m17:06:14.034896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:14.041547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:06:14.042695 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m17:06:14.043656 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:14.051468 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m17:06:14.053830 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: ROLLBACK
[0m17:06:14.054889 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe: Close
[0m17:06:14.056106 [error] [Thread-1 (]: 8 of 10 FAIL 30 unique_dim_product_product_id .................................. [[31mFAIL 30[0m in 0.06s]
[0m17:06:14.057287 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe
[0m17:06:14.058135 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:06:14.058916 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_postal_code ............................... [RUN]
[0m17:06:14.059840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_id.46495bf7fe, now test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638)
[0m17:06:14.060673 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:06:14.065878 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:06:14.080639 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:06:14.083046 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:06:14.096739 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:06:14.097724 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: BEGIN
[0m17:06:14.098460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:14.104716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:06:14.105893 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:06:14.106762 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    postal_code as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where postal_code is not null
group by postal_code
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:14.113601 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:06:14.115610 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: ROLLBACK
[0m17:06:14.116695 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: Close
[0m17:06:14.117807 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_dim_region_postal_code ................................... [[31mFAIL 1[0m in 0.06s]
[0m17:06:14.118916 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:06:14.119909 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:06:14.120854 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:06:14.121867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:06:14.122762 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:06:14.126549 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:06:14.141321 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:06:14.143903 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:06:14.160849 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:06:14.162011 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:06:14.162879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:14.175874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:06:14.176994 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:06:14.177827 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:06:14.402671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.224 seconds
[0m17:06:14.405336 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:06:14.406689 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:06:14.408015 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 0.29s]
[0m17:06:14.409370 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:06:14.411334 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.412274 [debug] [MainThread]: On master: BEGIN
[0m17:06:14.413173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:14.419571 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:06:14.420912 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.421670 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.422417 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.423329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:14.424193 [debug] [MainThread]: On master: Close
[0m17:06:14.425231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:14.426001 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:06:14.426927 [info ] [MainThread]: 
[0m17:06:14.427896 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m17:06:14.430138 [debug] [MainThread]: Command end result
[0m17:06:14.506080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:06:14.564534 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:06:14.584926 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:06:14.585883 [info ] [MainThread]: 
[0m17:06:14.586960 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:06:14.587897 [info ] [MainThread]: 
[0m17:06:14.588876 [error] [MainThread]: [31mFailure in test unique_dim_product_product_id (models/schema.yml)[0m
[0m17:06:14.589842 [error] [MainThread]:   Got 30 results, configured to fail if != 0
[0m17:06:14.590644 [info ] [MainThread]: 
[0m17:06:14.591606 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_product_product_id.sql
[0m17:06:14.592695 [info ] [MainThread]: 
[0m17:06:14.593656 [error] [MainThread]: [31mFailure in test unique_dim_region_postal_code (models/schema.yml)[0m
[0m17:06:14.594625 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:06:14.595621 [info ] [MainThread]: 
[0m17:06:14.596670 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_region_postal_code.sql
[0m17:06:14.597554 [info ] [MainThread]: 
[0m17:06:14.598419 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m17:06:14.599255 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m17:06:14.600078 [info ] [MainThread]: 
[0m17:06:14.601014 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m17:06:14.601956 [info ] [MainThread]: 
[0m17:06:14.602876 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m17:06:14.605270 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.0375953, "process_in_blocks": "103544", "process_kernel_time": 2.555744, "process_mem_max_rss": "115020", "process_out_blocks": "1600", "process_user_time": 3.027825}
[0m17:06:14.606249 [debug] [MainThread]: Command `dbt test` failed at 17:06:14.606133 after 4.04 seconds
[0m17:06:14.607143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea9b2b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea74c7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ea74c5490>]}
[0m17:06:14.607980 [debug] [MainThread]: Flushing usage events
[0m17:06:15.937558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:27.773041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d81683920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d815dbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d81680f20>]}


============================== 17:07:27.781728 | 892eba10-fba3-4b6a-b3bd-8e143fc74cb8 ==============================
[0m17:07:27.781728 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:07:27.782859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:07:28.033316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d813c63c0>]}
[0m17:07:28.085658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d80e85340>]}
[0m17:07:28.088687 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:07:28.197770 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:07:28.482366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:28.483697 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/schema.yml
[0m17:07:28.849230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d7f27f830>]}
[0m17:07:28.920122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:07:28.927802 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:07:29.597593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d7ce21d90>]}
[0m17:07:29.599132 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:07:29.600358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d7f3c0b60>]}
[0m17:07:29.603311 [info ] [MainThread]: 
[0m17:07:29.604517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:29.605535 [info ] [MainThread]: 
[0m17:07:29.606793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:29.611225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:07:30.037145 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:07:30.038390 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:07:30.039214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:30.098826 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m17:07:30.100088 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:07:30.101061 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:07:30.107770 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m17:07:30.109939 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:07:30.111121 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:07:30.116554 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.117600 [debug] [MainThread]: On master: BEGIN
[0m17:07:30.118468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:30.125576 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:07:30.127006 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.127873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:30.133649 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m17:07:30.137412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '892eba10-fba3-4b6a-b3bd-8e143fc74cb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d7d1ef6e0>]}
[0m17:07:30.138363 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:30.139353 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.140102 [debug] [MainThread]: On master: BEGIN
[0m17:07:30.141168 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:07:30.141978 [debug] [MainThread]: On master: COMMIT
[0m17:07:30.142770 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.143538 [debug] [MainThread]: On master: COMMIT
[0m17:07:30.144469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:30.145140 [debug] [MainThread]: On master: Close
[0m17:07:30.147602 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:07:30.148536 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:07:30.149519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:07:30.150505 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:07:30.163523 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:07:30.171025 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:07:30.183157 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:07:30.190366 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:07:30.191305 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:07:30.192058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.224703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m17:07:30.226941 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:07:30.228223 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:07:30.234257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:07:30.238989 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:07:30.240878 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:07:30.242309 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m17:07:30.243620 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:07:30.244506 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:07:30.245332 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:07:30.246298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3)
[0m17:07:30.247054 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:07:30.250658 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:07:30.263731 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:07:30.266066 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:07:30.273547 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:07:30.274706 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m17:07:30.275635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.282389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:07:30.283434 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:07:30.284320 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "sales_warehouse"."public"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m17:07:30.301671 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_key" does not exist
LINE 13: select product_key
                ^
HINT:  Perhaps you meant to reference the column "dim_product.product_id".

[0m17:07:30.303084 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m17:07:30.304283 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: Close
[0m17:07:30.313198 [debug] [Thread-1 (]: Database Error in test not_null_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 13: select product_key
                  ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_product_product_key.sql
[0m17:07:30.314680 [error] [Thread-1 (]: 2 of 10 ERROR not_null_dim_product_product_key ................................. [[31mERROR[0m in 0.07s]
[0m17:07:30.315979 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:07:30.317060 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:07:30.317545 [debug] [Thread-4 (]: Marking all children of 'test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 13: select product_key
                  ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_product_product_key.sql.
[0m17:07:30.318403 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_postal_code ............................. [RUN]
[0m17:07:30.320737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3, now test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870)
[0m17:07:30.321665 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:07:30.326723 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:07:30.334309 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:07:30.336885 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:07:30.344245 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:07:30.345247 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: BEGIN
[0m17:07:30.346079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.364722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:07:30.365981 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:07:30.366943 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select postal_code
from "sales_warehouse"."public"."dim_region"
where postal_code is null



      
    ) dbt_internal_test
[0m17:07:30.370463 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:07:30.372654 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: ROLLBACK
[0m17:07:30.373771 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: Close
[0m17:07:30.375048 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_postal_code ................................... [[32mPASS[0m in 0.05s]
[0m17:07:30.376310 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:07:30.377383 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:07:30.378320 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:07:30.379407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:07:30.380470 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:07:30.384238 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:07:30.391984 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:07:30.395716 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:07:30.416757 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:07:30.417795 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:07:30.418707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.424920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:07:30.425897 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:07:30.426690 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:07:30.431867 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:07:30.434429 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:07:30.435429 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:07:30.436692 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.06s]
[0m17:07:30.437852 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:07:30.438679 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:07:30.439470 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:07:30.440463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:07:30.441323 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:07:30.444812 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:07:30.452382 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:07:30.454580 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:07:30.461732 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:07:30.462891 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:07:30.463828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.470222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:07:30.471253 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:07:30.472216 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:07:30.477994 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:07:30.480003 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:07:30.480979 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:07:30.482004 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.04s]
[0m17:07:30.483158 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:07:30.484203 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:07:30.485100 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:07:30.486240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:07:30.487285 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:07:30.490874 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:07:30.497498 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:07:30.499984 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:07:30.507559 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:07:30.508494 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:07:30.509396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.515871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:07:30.517088 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:07:30.518212 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:07:30.523826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:07:30.526330 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:07:30.527359 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:07:30.528467 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m17:07:30.529742 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:07:30.530786 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:07:30.531672 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:07:30.532673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:07:30.533453 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:07:30.538648 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:07:30.545882 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:07:30.548463 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:07:30.555879 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:07:30.556939 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:07:30.557807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.565074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:07:30.566019 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:07:30.566787 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:30.571999 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:07:30.574456 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:07:30.575392 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:07:30.576414 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m17:07:30.577595 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:07:30.578496 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:07:30.579312 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_key .............................. [RUN]
[0m17:07:30.580323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_key.1753236bd0)
[0m17:07:30.581091 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:07:30.593675 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:07:30.600506 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:07:30.604169 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:07:30.622772 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:07:30.624567 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: BEGIN
[0m17:07:30.625447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.654643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m17:07:30.656116 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:07:30.657091 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:30.658675 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_key" does not exist
LINE 12:     product_key as unique_field,
             ^
HINT:  Perhaps you meant to reference the column "dim_product.product_id".

[0m17:07:30.659732 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m17:07:30.660913 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: Close
[0m17:07:30.663519 [debug] [Thread-1 (]: Database Error in test unique_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 12:     product_key as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_product_product_key.sql
[0m17:07:30.664717 [error] [Thread-1 (]: 8 of 10 ERROR unique_dim_product_product_key ................................... [[31mERROR[0m in 0.08s]
[0m17:07:30.666095 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:07:30.667114 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:07:30.667615 [debug] [Thread-4 (]: Marking all children of 'test.sales_dbt_project.unique_dim_product_product_key.1753236bd0' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 12:     product_key as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_product_product_key.sql.
[0m17:07:30.668415 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_postal_code ............................... [RUN]
[0m17:07:30.670306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_key.1753236bd0, now test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638)
[0m17:07:30.671279 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:07:30.675243 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:07:30.681813 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:07:30.684383 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:07:30.691125 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:07:30.692079 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: BEGIN
[0m17:07:30.692870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.702182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:07:30.703295 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:07:30.704104 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    postal_code as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where postal_code is not null
group by postal_code
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:30.710647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:07:30.712755 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: ROLLBACK
[0m17:07:30.714025 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: Close
[0m17:07:30.715423 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_dim_region_postal_code ................................... [[31mFAIL 1[0m in 0.05s]
[0m17:07:30.716616 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:07:30.717562 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:07:30.718391 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:07:30.719388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:07:30.720188 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:07:30.723676 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:07:30.730593 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:07:30.732909 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:07:30.739933 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:07:30.740958 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:07:30.741867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:30.753345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:07:30.754389 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:07:30.755123 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:07:30.978564 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.223 seconds
[0m17:07:30.980985 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:07:30.982180 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:07:30.983252 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 0.26s]
[0m17:07:30.984670 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:07:30.986642 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.987574 [debug] [MainThread]: On master: BEGIN
[0m17:07:30.988411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:30.994794 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:07:30.995845 [debug] [MainThread]: On master: COMMIT
[0m17:07:30.996626 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:30.997643 [debug] [MainThread]: On master: COMMIT
[0m17:07:30.998737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:30.999590 [debug] [MainThread]: On master: Close
[0m17:07:31.000611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:31.001375 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:07:31.002295 [info ] [MainThread]: 
[0m17:07:31.003207 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m17:07:31.005489 [debug] [MainThread]: Command end result
[0m17:07:31.035589 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:07:31.040707 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:07:31.050797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:07:31.051718 [info ] [MainThread]: 
[0m17:07:31.052732 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:07:31.053674 [info ] [MainThread]: 
[0m17:07:31.054637 [error] [MainThread]:   Database Error in test not_null_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 13: select product_key
                  ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_product_product_key.sql
[0m17:07:31.055521 [info ] [MainThread]: 
[0m17:07:31.056410 [error] [MainThread]:   Database Error in test unique_dim_product_product_key (models/schema.yml)
  column "product_key" does not exist
  LINE 12:     product_key as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "dim_product.product_id".
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_product_product_key.sql
[0m17:07:31.057213 [info ] [MainThread]: 
[0m17:07:31.058126 [error] [MainThread]: [31mFailure in test unique_dim_region_postal_code (models/schema.yml)[0m
[0m17:07:31.059139 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:07:31.060140 [info ] [MainThread]: 
[0m17:07:31.061115 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_region_postal_code.sql
[0m17:07:31.062335 [info ] [MainThread]: 
[0m17:07:31.063406 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m17:07:31.064410 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m17:07:31.065293 [info ] [MainThread]: 
[0m17:07:31.066250 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m17:07:31.067063 [info ] [MainThread]: 
[0m17:07:31.067923 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m17:07:31.071113 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.3604555, "process_in_blocks": "103832", "process_kernel_time": 1.384955, "process_mem_max_rss": "115988", "process_out_blocks": "1600", "process_user_time": 3.062666}
[0m17:07:31.072206 [debug] [MainThread]: Command `dbt test` failed at 17:07:31.072084 after 3.36 seconds
[0m17:07:31.073023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d84682900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d7ce883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5d81220200>]}
[0m17:07:31.073897 [debug] [MainThread]: Flushing usage events
[0m17:07:31.941504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:22.160254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d2b2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87cfffda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ecf49b0>]}


============================== 17:08:22.169106 | 3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71 ==============================
[0m17:08:22.169106 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:08:22.170169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:08:22.455288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87cce1160>]}
[0m17:08:22.509527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87e205940>]}
[0m17:08:22.511647 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:08:22.612806 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:08:22.883964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:22.885477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:22.919343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87b4f0230>]}
[0m17:08:22.991995 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:08:22.999330 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:08:23.087664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87b19fe90>]}
[0m17:08:23.088940 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:08:23.090089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87b4f0b30>]}
[0m17:08:23.092673 [info ] [MainThread]: 
[0m17:08:23.093735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:23.094627 [info ] [MainThread]: 
[0m17:08:23.095687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:23.099806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m17:08:23.227205 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m17:08:23.228412 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:08:23.229494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:23.261914 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m17:08:23.264682 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m17:08:23.267434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m17:08:23.272487 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:08:23.273430 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:08:23.274219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:23.280780 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:08:23.281774 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:08:23.282595 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:08:23.286573 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m17:08:23.288517 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:08:23.289590 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:08:23.295025 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.295949 [debug] [MainThread]: On master: BEGIN
[0m17:08:23.296739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:23.302808 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:08:23.303766 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.304697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:23.309287 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m17:08:23.312736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ccbb560>]}
[0m17:08:23.314191 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:23.315165 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.315950 [debug] [MainThread]: On master: BEGIN
[0m17:08:23.317079 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:08:23.317868 [debug] [MainThread]: On master: COMMIT
[0m17:08:23.318630 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.319422 [debug] [MainThread]: On master: COMMIT
[0m17:08:23.320226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:08:23.320978 [debug] [MainThread]: On master: Close
[0m17:08:23.323411 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m17:08:23.324478 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m17:08:23.325469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m17:08:23.326302 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m17:08:23.331427 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m17:08:23.345912 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m17:08:23.373922 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m17:08:23.389518 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.401861 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m17:08:23.402924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:23.410136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:08:23.411135 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.412009 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m17:08:23.560811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.148 seconds
[0m17:08:23.568013 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.569501 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:08:23.575095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:08:23.578221 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.579902 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:08:23.590266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m17:08:23.605102 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:08:23.606024 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.606848 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:08:23.608483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:08:23.613744 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m17:08:23.619689 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:08:23.620581 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m17:08:23.650753 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.029 seconds
[0m17:08:23.654204 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m17:08:23.656767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d86a180>]}
[0m17:08:23.658151 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:08:23.659382 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m17:08:23.661032 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m17:08:23.662189 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m17:08:23.663452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m17:08:23.664594 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m17:08:23.668069 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m17:08:23.682987 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m17:08:23.686245 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m17:08:23.700537 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:08:23.701591 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m17:08:23.702430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:23.716044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:08:23.717153 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:08:23.718032 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:08:23.722436 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:08:23.725327 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:08:23.726304 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:08:23.727670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:08:23.729201 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:08:23.730039 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:08:23.730912 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:08:23.732603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:08:23.735044 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m17:08:23.736168 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:08:23.736982 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m17:08:23.738481 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:23.740211 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m17:08:23.741302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87a431a90>]}
[0m17:08:23.742556 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:08:23.743780 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m17:08:23.744690 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m17:08:23.745613 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m17:08:23.746602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m17:08:23.747487 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m17:08:23.752395 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m17:08:23.774483 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m17:08:23.777700 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m17:08:23.793762 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:08:23.794841 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m17:08:23.795734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:23.802070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:08:23.803133 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:08:23.803945 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m17:08:23.806648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:08:23.809555 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:08:23.810358 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m17:08:23.811455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:08:23.812940 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:08:23.813729 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:08:23.814521 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:08:23.816674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:08:23.819041 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m17:08:23.820135 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:08:23.820943 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m17:08:23.821948 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:08:23.823449 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m17:08:23.824489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc878a80ef0>]}
[0m17:08:23.825601 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:08:23.826876 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m17:08:23.827877 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m17:08:23.828843 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m17:08:23.829967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m17:08:23.830748 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m17:08:23.833500 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m17:08:23.848170 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m17:08:23.851658 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m17:08:23.864715 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:08:23.865691 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m17:08:23.866702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:23.873299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:08:23.874424 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:08:23.875286 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_id || '-' || product_name AS product_key,
    product_id,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:08:23.877409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_id" does not exist
LINE 8:     product_id || '-' || product_name AS product_key,
            ^
HINT:  Perhaps you meant to reference the column "stg_orders.product_key".

[0m17:08:23.878313 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: ROLLBACK
[0m17:08:23.879297 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m17:08:23.887172 [debug] [Thread-1 (]: Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 8:     product_id || '-' || product_name AS product_key,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m17:08:23.888234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87b4c95b0>]}
[0m17:08:23.889391 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model public.dim_product ........................ [[31mERROR[0m in 0.06s]
[0m17:08:23.890484 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m17:08:23.891356 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m17:08:23.891864 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 8:     product_id || '-' || product_name AS product_key,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql.
[0m17:08:23.892716 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m17:08:23.894933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m17:08:23.895754 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m17:08:23.899724 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m17:08:23.914083 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m17:08:23.917174 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m17:08:23.930234 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:08:23.931209 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m17:08:23.932199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:23.939074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:08:23.940193 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:08:23.941109 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:08:23.943299 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:08:23.947015 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:08:23.947925 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m17:08:23.949069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:08:23.950521 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:08:23.951419 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:08:23.952235 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:08:23.954200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:08:23.956242 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m17:08:23.957248 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:08:23.958043 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m17:08:23.959081 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:08:23.960719 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m17:08:23.961723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2ed79a-dbe4-4e39-bc23-7dd1bea53a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc878a972f0>]}
[0m17:08:23.962809 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m17:08:23.963943 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m17:08:23.965219 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m17:08:23.966093 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.fact_orders ........................................ [[33mSKIP[0m]
[0m17:08:23.967102 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m17:08:23.968913 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.969799 [debug] [MainThread]: On master: BEGIN
[0m17:08:23.970536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:23.977384 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:08:23.978321 [debug] [MainThread]: On master: COMMIT
[0m17:08:23.979064 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:23.979785 [debug] [MainThread]: On master: COMMIT
[0m17:08:23.980641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:08:23.981397 [debug] [MainThread]: On master: Close
[0m17:08:23.982327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:23.983078 [debug] [MainThread]: Connection 'model.sales_dbt_project.dim_region' was properly closed.
[0m17:08:23.984072 [info ] [MainThread]: 
[0m17:08:23.985057 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m17:08:23.986858 [debug] [MainThread]: Command end result
[0m17:08:24.023373 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:08:24.028496 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:08:24.036855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:08:24.037920 [info ] [MainThread]: 
[0m17:08:24.038916 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:08:24.039835 [info ] [MainThread]: 
[0m17:08:24.040770 [error] [MainThread]:   Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 8:     product_id || '-' || product_name AS product_key,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m17:08:24.041655 [info ] [MainThread]: 
[0m17:08:24.042555 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:08:24.045712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9484723, "process_in_blocks": "38904", "process_kernel_time": 0.865114, "process_mem_max_rss": "108044", "process_out_blocks": "1600", "process_user_time": 1.953196}
[0m17:08:24.046936 [debug] [MainThread]: Command `dbt run` failed at 17:08:24.046806 after 1.95 seconds
[0m17:08:24.047944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87df06210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87cfb3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d88b050>]}
[0m17:08:24.048755 [debug] [MainThread]: Flushing usage events
[0m17:08:24.707757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:06.935793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e957b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e99d3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e957b0e0>]}


============================== 17:10:06.945245 | 26288dcd-6b66-411b-873d-1b8672efba3e ==============================
[0m17:10:06.945245 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:06.946487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:07.239197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107ec796900>]}
[0m17:10:07.295935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e90f3e60>]}
[0m17:10:07.298295 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:07.398340 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:10:07.678219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:07.679818 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_product.sql
[0m17:10:08.053727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e7700b00>]}
[0m17:10:08.186382 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:10:08.194642 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:10:08.295393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e75759d0>]}
[0m17:10:08.296842 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:10:08.297890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e75f65a0>]}
[0m17:10:08.300437 [info ] [MainThread]: 
[0m17:10:08.301717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:08.302645 [info ] [MainThread]: 
[0m17:10:08.303772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:08.308487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m17:10:08.530755 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m17:10:08.532069 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:10:08.533072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:08.584394 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m17:10:08.586469 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m17:10:08.588695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m17:10:08.593547 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:10:08.594417 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:10:08.595237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:08.601491 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:10:08.602416 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:10:08.603234 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:08.607567 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m17:10:08.609414 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:10:08.610334 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:10:08.615724 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:08.616576 [debug] [MainThread]: On master: BEGIN
[0m17:10:08.617313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:08.629799 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:10:08.630806 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:08.631614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:08.636248 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m17:10:08.639180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e5167650>]}
[0m17:10:08.640337 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:08.641591 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:08.642309 [debug] [MainThread]: On master: BEGIN
[0m17:10:08.643293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:10:08.644000 [debug] [MainThread]: On master: COMMIT
[0m17:10:08.644783 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:08.645517 [debug] [MainThread]: On master: COMMIT
[0m17:10:08.646381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:08.647187 [debug] [MainThread]: On master: Close
[0m17:10:08.649564 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m17:10:08.650537 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m17:10:08.651609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m17:10:08.652461 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m17:10:08.657768 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m17:10:08.664679 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m17:10:08.691166 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m17:10:08.698830 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.699921 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m17:10:08.700799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:08.707778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:10:08.708776 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.709646 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m17:10:08.731811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:10:08.738322 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.739407 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:10:08.741496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:08.744401 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.745434 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:10:08.746813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:08.759418 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:10:08.760734 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.761582 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:10:08.770592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:10:08.776106 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m17:10:08.781503 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:08.782396 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m17:10:08.786164 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:10:08.788671 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m17:10:08.791093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107eaf4a810>]}
[0m17:10:08.792506 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m17:10:08.793567 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m17:10:08.795116 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m17:10:08.796096 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m17:10:08.797227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m17:10:08.798075 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m17:10:08.800743 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m17:10:08.807283 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m17:10:08.811678 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m17:10:08.818651 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:08.819569 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m17:10:08.820437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:08.827049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:10:08.828052 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:08.828898 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:08.831118 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:10:08.834586 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:08.835706 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:10:08.837127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:08.838718 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:10:08.839613 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:08.840390 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:10:08.841938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:08.844132 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m17:10:08.845070 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:08.845803 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m17:10:08.847160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:10:08.848790 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m17:10:08.850151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e43f10d0>]}
[0m17:10:08.851259 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:08.852489 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m17:10:08.853354 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m17:10:08.854399 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m17:10:08.855309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m17:10:08.856065 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m17:10:08.858670 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m17:10:08.865467 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m17:10:08.868295 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m17:10:08.874873 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:08.875907 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m17:10:08.876845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:08.891219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:10:08.892348 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:08.893051 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m17:10:08.895648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:08.898524 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:08.899326 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m17:10:08.900329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:08.901810 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:10:08.902561 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:08.903265 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:10:08.904762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:08.907019 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m17:10:08.908637 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:08.909369 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m17:10:08.910285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:08.911945 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m17:10:08.913200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e5262930>]}
[0m17:10:08.914343 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:10:08.915413 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m17:10:08.916280 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m17:10:08.917209 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m17:10:08.918177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m17:10:08.919005 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m17:10:08.921402 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m17:10:08.928742 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m17:10:08.931614 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m17:10:08.939003 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:08.939955 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m17:10:08.940839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:08.947526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:10:08.948758 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:08.949546 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_key || '-' || product_name AS product_key,
    product_id,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:08.951785 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_id" does not exist
LINE 9:     product_id,
            ^
HINT:  Perhaps you meant to reference the column "stg_orders.product_key".

[0m17:10:08.952649 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: ROLLBACK
[0m17:10:08.953676 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m17:10:08.962195 [debug] [Thread-1 (]: Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 9:     product_id,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m17:10:08.963155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e44eda90>]}
[0m17:10:08.964312 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model public.dim_product ........................ [[31mERROR[0m in 0.05s]
[0m17:10:08.965421 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m17:10:08.966434 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m17:10:08.966910 [debug] [Thread-4 (]: Marking all children of 'model.sales_dbt_project.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 9:     product_id,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql.
[0m17:10:08.967711 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m17:10:08.970011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m17:10:08.970899 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m17:10:08.973498 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m17:10:08.980452 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m17:10:08.983542 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m17:10:08.990649 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:08.991399 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m17:10:08.992112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:08.999259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:10:09.000372 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:09.001246 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:09.003588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:09.007656 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:09.008536 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m17:10:09.009629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:09.011399 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:10:09.012231 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:09.013013 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:10:09.014607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:09.016979 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m17:10:09.018107 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:09.018995 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m17:10:09.020191 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:09.021943 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m17:10:09.022974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26288dcd-6b66-411b-873d-1b8672efba3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e4292210>]}
[0m17:10:09.024041 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:09.025298 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m17:10:09.026615 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m17:10:09.027582 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.fact_orders ........................................ [[33mSKIP[0m]
[0m17:10:09.028485 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m17:10:09.030218 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.031074 [debug] [MainThread]: On master: BEGIN
[0m17:10:09.031862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:09.038529 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:10:09.039662 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.040510 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:09.041372 [debug] [MainThread]: On master: COMMIT
[0m17:10:09.042528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:09.043307 [debug] [MainThread]: On master: Close
[0m17:10:09.044200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:09.044947 [debug] [MainThread]: Connection 'model.sales_dbt_project.dim_region' was properly closed.
[0m17:10:09.045877 [info ] [MainThread]: 
[0m17:10:09.046756 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:10:09.048577 [debug] [MainThread]: Command end result
[0m17:10:09.078329 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:10:09.083212 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:10:09.091535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:10:09.092483 [info ] [MainThread]: 
[0m17:10:09.093442 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:10:09.094357 [info ] [MainThread]: 
[0m17:10:09.095251 [error] [MainThread]:   Database Error in model dim_product (models/dimensions/dim_product.sql)
  column "product_id" does not exist
  LINE 9:     product_id,
              ^
  HINT:  Perhaps you meant to reference the column "stg_orders.product_key".
  compiled code at target/run/sales_dbt_project/models/dimensions/dim_product.sql
[0m17:10:09.096065 [info ] [MainThread]: 
[0m17:10:09.096996 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m17:10:09.099230 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2306292, "process_in_blocks": "101952", "process_kernel_time": 1.083116, "process_mem_max_rss": "112948", "process_out_blocks": "1600", "process_user_time": 2.486983}
[0m17:10:09.100380 [debug] [MainThread]: Command `dbt run` failed at 17:10:09.100276 after 2.23 seconds
[0m17:10:09.101252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e9b30080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e9b30770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107e7480890>]}
[0m17:10:09.102205 [debug] [MainThread]: Flushing usage events
[0m17:10:10.121534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:51.628742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06b265cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06941bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069b3a3f0>]}


============================== 17:10:51.651971 | a7899239-53e1-48d9-b3fc-d4f8103b2749 ==============================
[0m17:10:51.651971 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:51.653354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:51.949996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067af77a0>]}
[0m17:10:52.003516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06939fbc0>]}
[0m17:10:52.005504 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:52.098540 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:10:52.476546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:52.478225 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_product.sql
[0m17:10:52.962886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06770d850>]}
[0m17:10:53.035951 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:10:53.043231 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:10:53.102707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067935c10>]}
[0m17:10:53.103986 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:10:53.105183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe065572f30>]}
[0m17:10:53.107829 [info ] [MainThread]: 
[0m17:10:53.109289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:53.110515 [info ] [MainThread]: 
[0m17:10:53.111851 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:53.116693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m17:10:53.292447 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m17:10:53.293991 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:10:53.295085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:53.348096 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m17:10:53.350267 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m17:10:53.352846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m17:10:53.359041 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:10:53.360026 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:10:53.360777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:53.381205 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m17:10:53.382397 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:10:53.383256 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:53.387696 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m17:10:53.389587 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:10:53.390522 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:10:53.395550 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.396366 [debug] [MainThread]: On master: BEGIN
[0m17:10:53.397139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:53.424319 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m17:10:53.425536 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.426435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:53.430940 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m17:10:53.433915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06939f4a0>]}
[0m17:10:53.434999 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:53.436052 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.436888 [debug] [MainThread]: On master: BEGIN
[0m17:10:53.438072 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:10:53.438946 [debug] [MainThread]: On master: COMMIT
[0m17:10:53.439757 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.440577 [debug] [MainThread]: On master: COMMIT
[0m17:10:53.441639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:53.442504 [debug] [MainThread]: On master: Close
[0m17:10:53.444994 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m17:10:53.446149 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m17:10:53.447165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m17:10:53.448060 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m17:10:53.453911 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m17:10:53.461934 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m17:10:53.490276 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m17:10:53.498198 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.499241 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m17:10:53.500063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.506319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:10:53.507487 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.508430 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m17:10:53.514905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:10:53.520971 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.521900 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:10:53.523735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:53.527235 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.528158 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:10:53.529478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.542623 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:10:53.543662 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.544547 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:10:53.546330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:53.552010 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m17:10:53.557498 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:10:53.558599 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m17:10:53.562244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:10:53.564963 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m17:10:53.567725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06b3226c0>]}
[0m17:10:53.568768 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:10:53.569879 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m17:10:53.571421 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m17:10:53.572430 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m17:10:53.573398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m17:10:53.574312 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m17:10:53.577138 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m17:10:53.584097 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m17:10:53.588770 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m17:10:53.595739 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:53.596588 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m17:10:53.597397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.614512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:10:53.615634 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:53.616424 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:53.619060 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:53.622272 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:53.623096 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:10:53.624381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.625905 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:10:53.626700 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:53.627500 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:10:53.628937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:53.631234 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m17:10:53.632228 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:10:53.633035 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m17:10:53.634403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:10:53.636059 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m17:10:53.637767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0646401a0>]}
[0m17:10:53.638849 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:10:53.639920 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m17:10:53.640762 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m17:10:53.641662 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m17:10:53.642626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m17:10:53.643378 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m17:10:53.645882 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m17:10:53.653026 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m17:10:53.655942 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m17:10:53.662846 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:53.663741 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m17:10:53.664660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.677925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:10:53.679142 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:53.680241 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m17:10:53.683579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:53.686972 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:53.688104 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m17:10:53.689582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.691194 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:10:53.691947 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:53.692788 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:10:53.695162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:10:53.697565 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m17:10:53.698607 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:10:53.699373 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m17:10:53.700406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:53.701954 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m17:10:53.703055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0646ee720>]}
[0m17:10:53.704131 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:10:53.705281 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m17:10:53.706148 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m17:10:53.707009 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m17:10:53.719215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m17:10:53.720197 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m17:10:53.722958 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m17:10:53.729748 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m17:10:53.732737 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m17:10:53.739782 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:53.740654 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m17:10:53.741431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.748320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:10:53.749614 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:53.750587 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_key || '-' || product_name AS product_key,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:53.753160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:53.756086 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:53.756912 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:10:53.758185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.759869 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m17:10:53.760715 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:53.761502 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m17:10:53.763114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:53.765177 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m17:10:53.766191 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:10:53.767031 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m17:10:53.768219 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:53.769798 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m17:10:53.770776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe064652cc0>]}
[0m17:10:53.771865 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:53.773025 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m17:10:53.774012 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m17:10:53.774982 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m17:10:53.776063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m17:10:53.776978 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m17:10:53.779719 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m17:10:53.786250 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m17:10:53.790505 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m17:10:53.797371 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:53.798341 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m17:10:53.799155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.805561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:10:53.806858 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:53.807760 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:10:53.810702 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:10:53.814173 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:53.815221 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m17:10:53.816568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.818492 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:10:53.819437 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:53.820313 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:10:53.821875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:53.824342 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m17:10:53.825428 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:10:53.826311 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m17:10:53.827570 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:53.829491 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m17:10:53.830538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0645fc680>]}
[0m17:10:53.831644 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:10:53.832836 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m17:10:53.834347 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m17:10:53.835540 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m17:10:53.836759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m17:10:53.837940 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m17:10:53.841850 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m17:10:53.857316 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m17:10:53.860768 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m17:10:53.887831 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:10:53.888839 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m17:10:53.889717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:53.909241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:10:53.910407 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:10:53.911398 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_key,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_key = p.product_key
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region = r.region
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m17:10:53.923983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:10:53.927521 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:10:53.928450 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m17:10:53.929811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:10:53.931608 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m17:10:53.932368 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:10:53.933181 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m17:10:53.934759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:10:53.936895 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m17:10:53.938000 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:10:53.938950 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m17:10:53.940106 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:10:53.941662 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m17:10:53.942642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7899239-53e1-48d9-b3fc-d4f8103b2749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe064640b30>]}
[0m17:10:53.943751 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m17:10:53.944958 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m17:10:53.946792 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.947563 [debug] [MainThread]: On master: BEGIN
[0m17:10:53.954266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:53.960995 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:10:53.962021 [debug] [MainThread]: On master: COMMIT
[0m17:10:53.962783 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.963457 [debug] [MainThread]: On master: COMMIT
[0m17:10:53.964312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:53.965107 [debug] [MainThread]: On master: Close
[0m17:10:53.966059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:53.966780 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m17:10:53.967569 [info ] [MainThread]: 
[0m17:10:53.968403 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m17:10:53.970435 [debug] [MainThread]: Command end result
[0m17:10:53.999730 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:10:54.004449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:10:54.013238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:10:54.014172 [info ] [MainThread]: 
[0m17:10:54.015253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:54.016170 [info ] [MainThread]: 
[0m17:10:54.017041 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:10:54.019186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4589946, "process_in_blocks": "23392", "process_kernel_time": 1.059502, "process_mem_max_rss": "111800", "process_out_blocks": "1600", "process_user_time": 2.62353}
[0m17:10:54.020199 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:54.020097 after 2.46 seconds
[0m17:10:54.021096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069752bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06553ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0655ea0c0>]}
[0m17:10:54.022114 [debug] [MainThread]: Flushing usage events
[0m17:10:54.658007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:14.827900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4b93ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4cd96db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4b93ce60>]}


============================== 17:11:14.835403 | 35da1c59-8e74-434f-88fc-1cac117e99cc ==============================
[0m17:11:14.835403 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:11:14.836608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:15.021793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4946c7a0>]}
[0m17:11:15.075552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4ad0f980>]}
[0m17:11:15.129046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:11:15.215827 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:11:15.499604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:15.501100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:15.534635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4b2f93d0>]}
[0m17:11:15.606633 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:11:15.612713 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:11:15.658577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e49525fd0>]}
[0m17:11:15.659634 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:11:15.660829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4ad3aba0>]}
[0m17:11:15.663553 [info ] [MainThread]: 
[0m17:11:15.664934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:15.676428 [info ] [MainThread]: 
[0m17:11:15.677643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:15.681932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:11:15.774122 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:11:15.775473 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:11:15.776425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:15.795835 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m17:11:15.797124 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:11:15.797951 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:11:15.802480 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m17:11:15.804356 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:11:15.805327 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:11:15.811012 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:15.811962 [debug] [MainThread]: On master: BEGIN
[0m17:11:15.812821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:15.819179 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:11:15.820161 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:15.821055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:15.825882 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m17:11:15.829450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35da1c59-8e74-434f-88fc-1cac117e99cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e48ddc800>]}
[0m17:11:15.830399 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:15.831301 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:15.832061 [debug] [MainThread]: On master: BEGIN
[0m17:11:15.833173 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:11:15.834108 [debug] [MainThread]: On master: COMMIT
[0m17:11:15.835087 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:15.835842 [debug] [MainThread]: On master: COMMIT
[0m17:11:15.836773 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:15.837719 [debug] [MainThread]: On master: Close
[0m17:11:15.840586 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:11:15.841611 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:11:15.842722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:11:15.843619 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:11:15.856322 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:11:15.863687 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:11:15.876881 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:11:15.884453 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:11:15.885324 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:11:15.886121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:15.892523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:11:15.893555 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:11:15.894506 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:11:15.899163 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:11:15.903063 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:11:15.904377 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:11:15.905784 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m17:11:15.906890 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:11:15.907774 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:11:15.908632 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:11:15.909588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3)
[0m17:11:15.910435 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:11:15.914699 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:11:15.922208 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:11:15.925681 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:11:15.932730 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:11:15.933657 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m17:11:15.934551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:15.941350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:11:15.942558 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:11:15.943396 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "sales_warehouse"."public"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m17:11:15.961371 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:11:15.963751 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m17:11:15.965025 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: Close
[0m17:11:15.966171 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.06s]
[0m17:11:15.967373 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:11:15.968258 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:11:15.969167 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_postal_code ............................. [RUN]
[0m17:11:15.970257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3, now test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870)
[0m17:11:15.971162 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:11:15.974745 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:11:15.997503 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:11:16.000058 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:11:16.007050 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:11:16.007910 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: BEGIN
[0m17:11:16.008733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.015500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:11:16.016482 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:11:16.017349 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select postal_code
from "sales_warehouse"."public"."dim_region"
where postal_code is null



      
    ) dbt_internal_test
[0m17:11:16.020599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:11:16.023082 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: ROLLBACK
[0m17:11:16.024114 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: Close
[0m17:11:16.025171 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_postal_code ................................... [[32mPASS[0m in 0.05s]
[0m17:11:16.026328 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:11:16.027334 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:11:16.028124 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:11:16.029041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:11:16.029826 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:11:16.033319 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:11:16.039948 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:11:16.042160 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:11:16.049123 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:11:16.050119 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:11:16.050911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.058000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:11:16.059044 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:11:16.059959 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:11:16.065716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:11:16.068356 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:11:16.069265 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:11:16.070352 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.04s]
[0m17:11:16.071546 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:11:16.072534 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:11:16.073405 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:11:16.074472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:11:16.075401 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:11:16.079340 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:11:16.086538 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:11:16.089119 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:11:16.095450 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:11:16.096236 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:11:16.097047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.103433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:11:16.104742 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:11:16.105642 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:11:16.111744 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:11:16.114155 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:11:16.115236 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:11:16.116291 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.04s]
[0m17:11:16.117354 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:11:16.118285 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:11:16.119167 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:11:16.120229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:11:16.120931 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:11:16.124371 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:11:16.131032 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:11:16.133270 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:11:16.140015 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:11:16.141038 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:11:16.141833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.149003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:11:16.150101 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:11:16.151048 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:11:16.156651 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:11:16.158812 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:11:16.159744 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:11:16.160887 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m17:11:16.162015 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:11:16.162893 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:11:16.163657 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:11:16.175504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:11:16.176539 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:11:16.182001 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:11:16.188677 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:11:16.191240 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:11:16.198425 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:11:16.199505 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:11:16.200496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.207029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:11:16.208117 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:11:16.208965 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:11:16.214207 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:11:16.216561 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:11:16.217768 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:11:16.219100 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m17:11:16.220286 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:11:16.221215 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:11:16.222127 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_key .............................. [RUN]
[0m17:11:16.223080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_key.1753236bd0)
[0m17:11:16.223866 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:11:16.228763 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:11:16.236509 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:11:16.239098 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:11:16.245995 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:11:16.246898 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: BEGIN
[0m17:11:16.247702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.254008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:11:16.254946 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:11:16.255801 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:11:16.266886 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m17:11:16.269130 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m17:11:16.270203 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: Close
[0m17:11:16.271304 [info ] [Thread-1 (]: 8 of 10 PASS unique_dim_product_product_key .................................... [[32mPASS[0m in 0.05s]
[0m17:11:16.272345 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:11:16.273267 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:11:16.274264 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_postal_code ............................... [RUN]
[0m17:11:16.275183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_key.1753236bd0, now test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638)
[0m17:11:16.276051 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:11:16.279502 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:11:16.286462 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:11:16.288749 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:11:16.296908 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:11:16.298080 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: BEGIN
[0m17:11:16.298973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.306737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:11:16.307884 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:11:16.308784 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    postal_code as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where postal_code is not null
group by postal_code
having count(*) > 1



      
    ) dbt_internal_test
[0m17:11:16.315343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:11:16.317673 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: ROLLBACK
[0m17:11:16.318824 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: Close
[0m17:11:16.319983 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_dim_region_postal_code ................................... [[31mFAIL 1[0m in 0.04s]
[0m17:11:16.321367 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:11:16.322417 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:11:16.323336 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:11:16.324454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:11:16.325365 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:11:16.328914 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:11:16.337072 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:11:16.339659 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:11:16.347613 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:11:16.348730 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:11:16.349695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:16.356244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:11:16.357418 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:11:16.358317 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:11:21.004759 [debug] [Thread-1 (]: SQL status: SELECT 1 in 4.645 seconds
[0m17:11:21.007332 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:11:21.008357 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:11:21.009509 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 4.69s]
[0m17:11:21.010643 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:11:21.012582 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:21.013367 [debug] [MainThread]: On master: BEGIN
[0m17:11:21.014247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:21.021155 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:11:21.022410 [debug] [MainThread]: On master: COMMIT
[0m17:11:21.023479 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:21.024437 [debug] [MainThread]: On master: COMMIT
[0m17:11:21.025397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:11:21.026256 [debug] [MainThread]: On master: Close
[0m17:11:21.027244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:21.028012 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:11:21.028986 [info ] [MainThread]: 
[0m17:11:21.029926 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m17:11:21.032254 [debug] [MainThread]: Command end result
[0m17:11:21.063291 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:11:21.068359 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:11:21.078358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:11:21.079283 [info ] [MainThread]: 
[0m17:11:21.080230 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:11:21.081254 [info ] [MainThread]: 
[0m17:11:21.082466 [error] [MainThread]: [31mFailure in test unique_dim_region_postal_code (models/schema.yml)[0m
[0m17:11:21.083520 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:11:21.084696 [info ] [MainThread]: 
[0m17:11:21.085850 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_region_postal_code.sql
[0m17:11:21.086782 [info ] [MainThread]: 
[0m17:11:21.087883 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m17:11:21.088817 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m17:11:21.089643 [info ] [MainThread]: 
[0m17:11:21.090667 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m17:11:21.091591 [info ] [MainThread]: 
[0m17:11:21.092537 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m17:11:21.094142 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.319512, "process_in_blocks": "42352", "process_kernel_time": 0.939626, "process_mem_max_rss": "110044", "process_out_blocks": "1600", "process_user_time": 2.441995}
[0m17:11:21.095168 [debug] [MainThread]: Command `dbt test` failed at 17:11:21.095048 after 6.32 seconds
[0m17:11:21.096100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4b19c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4adcc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754e4b1d67e0>]}
[0m17:11:21.097157 [debug] [MainThread]: Flushing usage events
[0m17:11:21.958297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:15.255175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c230bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c1cf92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c1cf8830>]}


============================== 17:15:15.264981 | e250dca0-1a5c-4acc-9160-4cbf1dfb63f7 ==============================
[0m17:15:15.264981 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:15:15.266207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:15:15.511731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c20e9af0>]}
[0m17:15:15.563271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c26a4e90>]}
[0m17:15:15.565266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:15.656765 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:15:15.985977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:15:15.987733 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/fact_orders.sql
[0m17:15:15.988659 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/staging/stg_orders.sql
[0m17:15:15.989523 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/dimensions/dim_region.sql
[0m17:15:16.357854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950bdcd29c0>]}
[0m17:15:16.429786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:15:16.436736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:15:16.491937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950bd8421e0>]}
[0m17:15:16.493211 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:15:16.494309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950bdcd2990>]}
[0m17:15:16.497246 [info ] [MainThread]: 
[0m17:15:16.498425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:16.499410 [info ] [MainThread]: 
[0m17:15:16.500668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:16.505951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:15:17.060898 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:15:17.062134 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:15:17.063005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:17.179759 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m17:15:17.181084 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:15:17.181902 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:15:17.186911 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m17:15:17.188860 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:15:17.190369 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:15:17.195902 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.197154 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.198129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:17.204727 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:15:17.205961 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.206966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:17.212684 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m17:15:17.216586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e250dca0-1a5c-4acc-9160-4cbf1dfb63f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c1a6f710>]}
[0m17:15:17.217585 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:17.218662 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.219398 [debug] [MainThread]: On master: BEGIN
[0m17:15:17.220445 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:15:17.221211 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.221986 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:17.222736 [debug] [MainThread]: On master: COMMIT
[0m17:15:17.223618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:17.224355 [debug] [MainThread]: On master: Close
[0m17:15:17.227153 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:17.228146 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:15:17.229201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:15:17.230122 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:17.242481 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:17.249774 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:17.261312 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:17.268422 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:17.269448 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:15:17.270292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.276641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:17.277675 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:17.278591 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:15:17.283060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:15:17.287458 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:15:17.288478 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:15:17.289573 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m17:15:17.290675 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:17.291562 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:17.292399 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:15:17.293295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3)
[0m17:15:17.294081 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:17.297613 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:17.304288 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:17.306345 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:17.313421 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:17.314442 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m17:15:17.315251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.321541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:17.322611 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:17.323473 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "sales_warehouse"."public"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m17:15:17.328498 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:15:17.330944 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m17:15:17.331943 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: Close
[0m17:15:17.333048 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.04s]
[0m17:15:17.334168 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:17.335004 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:15:17.335806 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_postal_code ............................. [RUN]
[0m17:15:17.336742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3, now test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870)
[0m17:15:17.337589 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:15:17.341913 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:15:17.348915 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:15:17.351789 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:15:17.359162 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:15:17.360077 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: BEGIN
[0m17:15:17.360889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.367894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:17.368905 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"
[0m17:15:17.369772 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select postal_code
from "sales_warehouse"."public"."dim_region"
where postal_code is null



      
    ) dbt_internal_test
[0m17:15:17.373061 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:15:17.375469 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: ROLLBACK
[0m17:15:17.376594 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870: Close
[0m17:15:17.377711 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_postal_code ................................... [[32mPASS[0m in 0.04s]
[0m17:15:17.378842 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870
[0m17:15:17.379663 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:17.380498 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:15:17.381508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_postal_code.982ae7c870, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:15:17.382326 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:17.385892 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:17.392213 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:17.394569 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:17.401676 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:17.402626 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:15:17.403366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.411046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:15:17.412169 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:17.413092 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:15:17.419103 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:17.421482 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:15:17.422483 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:15:17.423537 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.04s]
[0m17:15:17.424594 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:17.425522 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:17.426281 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:15:17.427203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:15:17.428052 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:17.431961 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:17.439156 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:17.441746 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:17.448903 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:17.449841 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:15:17.450629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.534066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m17:15:17.535681 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:17.536916 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:15:17.544235 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:15:17.546708 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:15:17.548010 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:15:17.549297 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.12s]
[0m17:15:17.550731 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:17.551701 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:17.552519 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:15:17.553448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:15:17.554329 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:17.557991 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:17.564850 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:17.566951 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:17.573807 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:17.574859 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:15:17.575690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.582784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:17.583738 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:17.584580 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:15:17.590320 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:17.592424 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:15:17.593427 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:15:17.594412 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m17:15:17.595478 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:17.596334 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:17.597189 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:15:17.598225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:15:17.599052 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:17.604617 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:17.612074 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:17.614740 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:17.621951 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:17.622980 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:15:17.623885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.630539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:17.631879 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:17.632646 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:17.638207 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:17.640906 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:15:17.642004 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:15:17.643078 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m17:15:17.644339 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:17.645182 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:17.646080 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_key .............................. [RUN]
[0m17:15:17.647114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_key.1753236bd0)
[0m17:15:17.647961 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:17.651297 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:17.658116 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:17.660231 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:17.666684 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:17.667921 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: BEGIN
[0m17:15:17.668730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.675456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:17.676548 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:17.677310 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:17.687251 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m17:15:17.690078 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m17:15:17.691110 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: Close
[0m17:15:17.692273 [info ] [Thread-1 (]: 8 of 10 PASS unique_dim_product_product_key .................................... [[32mPASS[0m in 0.05s]
[0m17:15:17.693500 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:17.694395 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:15:17.695295 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_postal_code ............................... [RUN]
[0m17:15:17.696417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_key.1753236bd0, now test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638)
[0m17:15:17.697269 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:15:17.702140 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:15:17.709436 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:15:17.711904 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:15:17.718949 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:15:17.719923 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: BEGIN
[0m17:15:17.720716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.741194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:15:17.742632 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"
[0m17:15:17.743591 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    postal_code as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where postal_code is not null
group by postal_code
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:17.749749 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:17.751815 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: ROLLBACK
[0m17:15:17.752804 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638: Close
[0m17:15:17.753907 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_dim_region_postal_code ................................... [[31mFAIL 1[0m in 0.06s]
[0m17:15:17.755082 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638
[0m17:15:17.756034 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:17.756864 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:15:17.757794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_postal_code.4defcbe638, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:15:17.758641 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:17.762285 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:17.769479 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:17.771816 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:17.780089 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:17.781106 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:15:17.781984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:17.788249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:17.789491 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:17.790395 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:20.875714 [debug] [Thread-1 (]: SQL status: SELECT 1 in 3.084 seconds
[0m17:15:20.878160 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:15:20.879344 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:15:20.880466 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 3.12s]
[0m17:15:20.881820 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:20.883811 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:20.884761 [debug] [MainThread]: On master: BEGIN
[0m17:15:20.885637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:20.892026 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:15:20.893230 [debug] [MainThread]: On master: COMMIT
[0m17:15:20.894143 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:20.895140 [debug] [MainThread]: On master: COMMIT
[0m17:15:20.896331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:20.897541 [debug] [MainThread]: On master: Close
[0m17:15:20.898728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:20.899558 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:15:20.900520 [info ] [MainThread]: 
[0m17:15:20.901649 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m17:15:20.904240 [debug] [MainThread]: Command end result
[0m17:15:21.024587 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:15:21.029623 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:15:21.039340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:15:21.040201 [info ] [MainThread]: 
[0m17:15:21.041174 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:15:21.042234 [info ] [MainThread]: 
[0m17:15:21.043151 [error] [MainThread]: [31mFailure in test unique_dim_region_postal_code (models/schema.yml)[0m
[0m17:15:21.044020 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:15:21.044870 [info ] [MainThread]: 
[0m17:15:21.045979 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_dim_region_postal_code.sql
[0m17:15:21.046838 [info ] [MainThread]: 
[0m17:15:21.047731 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m17:15:21.048605 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m17:15:21.049461 [info ] [MainThread]: 
[0m17:15:21.050456 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m17:15:21.051326 [info ] [MainThread]: 
[0m17:15:21.052172 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m17:15:21.056391 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.87266, "process_in_blocks": "103520", "process_kernel_time": 1.065438, "process_mem_max_rss": "115168", "process_out_blocks": "1600", "process_user_time": 3.044109}
[0m17:15:21.057623 [debug] [MainThread]: Command `dbt test` failed at 17:15:21.057504 after 5.87 seconds
[0m17:15:21.058502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c1d66ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950bdc439e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7950c23797f0>]}
[0m17:15:21.059352 [debug] [MainThread]: Flushing usage events
[0m17:15:21.893659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:47.517231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652f610620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652dbc1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652e320cb0>]}


============================== 17:15:47.524266 | ae489680-abd3-45d3-960b-203f386d7b5c ==============================
[0m17:15:47.524266 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:15:47.525438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:47.718673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652d608710>]}
[0m17:15:47.772107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652bd4c080>]}
[0m17:15:47.773873 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:47.857231 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:15:48.078661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:15:48.080479 [debug] [MainThread]: Partial parsing: updated file: sales_dbt_project://models/schema.yml
[0m17:15:48.470267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652ba32270>]}
[0m17:15:48.707683 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:15:48.904815 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:15:49.145566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6529792900>]}
[0m17:15:49.146745 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:15:49.147855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652bdf3da0>]}
[0m17:15:49.150565 [info ] [MainThread]: 
[0m17:15:49.151801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:49.152769 [info ] [MainThread]: 
[0m17:15:49.153822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:49.159242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:15:49.259236 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:15:49.260545 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:15:49.261455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:49.281770 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m17:15:49.282961 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:15:49.283800 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:15:49.287855 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m17:15:49.290044 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:15:49.291062 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:15:49.296483 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:49.297376 [debug] [MainThread]: On master: BEGIN
[0m17:15:49.298170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:49.315443 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m17:15:49.316658 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:49.317660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:49.322546 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m17:15:49.325968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae489680-abd3-45d3-960b-203f386d7b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b65293b3d10>]}
[0m17:15:49.326980 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:49.328046 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:49.329027 [debug] [MainThread]: On master: BEGIN
[0m17:15:49.330115 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:15:49.330889 [debug] [MainThread]: On master: COMMIT
[0m17:15:49.331629 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:49.332328 [debug] [MainThread]: On master: COMMIT
[0m17:15:49.333207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:49.334003 [debug] [MainThread]: On master: Close
[0m17:15:49.336555 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:49.337511 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:15:49.338481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:15:49.339333 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:49.352160 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:49.359312 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:49.371300 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:49.378822 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:49.379755 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:15:49.380686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.387607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.388561 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:15:49.389285 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:15:49.393964 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:15:49.398475 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:15:49.399511 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:15:49.400636 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m17:15:49.401740 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:15:49.402611 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:49.403528 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:15:49.404457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3)
[0m17:15:49.405271 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:49.408751 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:49.415527 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:49.418346 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:49.425102 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:49.426019 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m17:15:49.426886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.433250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:49.434575 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:15:49.435406 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "sales_warehouse"."public"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m17:15:49.440340 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:15:49.442349 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m17:15:49.443716 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: Close
[0m17:15:49.445008 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.04s]
[0m17:15:49.446107 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:15:49.447105 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:15:49.447983 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_region_key .............................. [RUN]
[0m17:15:49.448980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3, now test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def)
[0m17:15:49.449835 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:15:49.454184 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:15:49.461897 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:15:49.464093 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:15:49.471522 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:15:49.472711 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: BEGIN
[0m17:15:49.473696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.480577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.481741 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:15:49.482588 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_key
from "sales_warehouse"."public"."dim_region"
where region_key is null



      
    ) dbt_internal_test
[0m17:15:49.486217 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "region_key" does not exist
LINE 13: select region_key
                ^

[0m17:15:49.487198 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: ROLLBACK
[0m17:15:49.488307 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: Close
[0m17:15:49.497263 [debug] [Thread-1 (]: Database Error in test not_null_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 13: select region_key
                  ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_region_region_key.sql
[0m17:15:49.498750 [error] [Thread-1 (]: 3 of 10 ERROR not_null_dim_region_region_key ................................... [[31mERROR[0m in 0.05s]
[0m17:15:49.500010 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:15:49.500913 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:49.501386 [debug] [Thread-4 (]: Marking all children of 'test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 13: select region_key
                  ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_region_region_key.sql.
[0m17:15:49.502072 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:15:49.504165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:15:49.504958 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:49.508593 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:49.515505 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:49.517795 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:49.524622 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:49.525589 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:15:49.526417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.533024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.534154 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:15:49.534976 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:15:49.539151 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:15:49.541198 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:15:49.542323 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:15:49.543399 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.04s]
[0m17:15:49.544599 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:15:49.545580 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:49.546463 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:15:49.547534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:15:49.548373 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:49.552166 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:49.559631 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:49.562011 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:49.568257 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:49.569057 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:15:49.569908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.576815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.578159 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:15:49.579513 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:15:49.585150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:49.587129 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:15:49.588177 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:15:49.589238 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.04s]
[0m17:15:49.590412 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:15:49.591351 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:49.592193 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:15:49.593183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:15:49.593969 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:49.597499 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:49.604569 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:49.607172 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:49.613987 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:49.614835 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:15:49.615635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.622366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.623538 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:15:49.624449 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:15:49.630086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:49.632480 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:15:49.633622 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:15:49.634905 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m17:15:49.636082 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:15:49.637025 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:49.637967 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:15:49.638966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:15:49.639808 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:49.645072 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:49.651626 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:49.653995 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:49.660284 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:49.661354 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:15:49.662207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.669109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.670321 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:15:49.671273 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:49.676802 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:15:49.678861 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:15:49.679805 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:15:49.680983 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m17:15:49.682119 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:15:49.683055 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:49.683948 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_key .............................. [RUN]
[0m17:15:49.684976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_key.1753236bd0)
[0m17:15:49.685856 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:49.689407 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:49.696773 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:49.700673 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:49.708119 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:49.709141 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: BEGIN
[0m17:15:49.709899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.716251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:49.717181 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:15:49.718018 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:49.728113 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m17:15:49.730082 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m17:15:49.731065 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: Close
[0m17:15:49.732292 [info ] [Thread-1 (]: 8 of 10 PASS unique_dim_product_product_key .................................... [[32mPASS[0m in 0.05s]
[0m17:15:49.733390 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:15:49.734252 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:15:49.735088 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_region_key ................................ [RUN]
[0m17:15:49.736178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_key.1753236bd0, now test.sales_dbt_project.unique_dim_region_region_key.66a133323f)
[0m17:15:49.737034 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:15:49.740757 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:15:49.748896 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:15:49.751601 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:15:49.759365 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:15:49.760560 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: BEGIN
[0m17:15:49.761523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.767961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:15:49.769150 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:15:49.770035 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where region_key is not null
group by region_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:49.771408 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "region_key" does not exist
LINE 12:     region_key as unique_field,
             ^

[0m17:15:49.772302 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: ROLLBACK
[0m17:15:49.773324 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: Close
[0m17:15:49.775759 [debug] [Thread-1 (]: Database Error in test unique_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 12:     region_key as unique_field,
               ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_region_region_key.sql
[0m17:15:49.776882 [error] [Thread-1 (]: 9 of 10 ERROR unique_dim_region_region_key ..................................... [[31mERROR[0m in 0.04s]
[0m17:15:49.778043 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:15:49.778912 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:49.779305 [debug] [Thread-4 (]: Marking all children of 'test.sales_dbt_project.unique_dim_region_region_key.66a133323f' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 12:     region_key as unique_field,
               ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_region_region_key.sql.
[0m17:15:49.779952 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:15:49.781685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_region_key.66a133323f, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:15:49.782529 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:49.786184 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:49.793491 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:49.795713 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:49.802326 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:49.803254 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:15:49.804146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:49.810828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:15:49.811958 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:15:49.812951 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:15:53.228736 [debug] [Thread-1 (]: SQL status: SELECT 1 in 3.416 seconds
[0m17:15:53.230764 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:15:53.231901 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:15:53.232992 [error] [Thread-1 (]: 10 of 10 FAIL 9695 unique_fact_orders_order_key ................................ [[31mFAIL 9695[0m in 3.45s]
[0m17:15:53.234350 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:15:53.236360 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:53.237236 [debug] [MainThread]: On master: BEGIN
[0m17:15:53.238063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:53.244587 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:15:53.245817 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.246619 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:53.247390 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.248432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:53.249303 [debug] [MainThread]: On master: Close
[0m17:15:53.250224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:53.251047 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:15:53.251881 [info ] [MainThread]: 
[0m17:15:53.252718 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m17:15:53.255181 [debug] [MainThread]: Command end result
[0m17:15:53.285971 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:15:53.291012 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:15:53.300500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:15:53.301418 [info ] [MainThread]: 
[0m17:15:53.302670 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:15:53.303727 [info ] [MainThread]: 
[0m17:15:53.304713 [error] [MainThread]:   Database Error in test not_null_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 13: select region_key
                  ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/not_null_dim_region_region_key.sql
[0m17:15:53.305658 [info ] [MainThread]: 
[0m17:15:53.306669 [error] [MainThread]:   Database Error in test unique_dim_region_region_key (models/schema.yml)
  column "region_key" does not exist
  LINE 12:     region_key as unique_field,
               ^
  compiled code at target/run/sales_dbt_project/models/schema.yml/unique_dim_region_region_key.sql
[0m17:15:53.307572 [info ] [MainThread]: 
[0m17:15:53.308507 [error] [MainThread]: [31mFailure in test unique_fact_orders_order_key (models/schema.yml)[0m
[0m17:15:53.309432 [error] [MainThread]:   Got 9695 results, configured to fail if != 0
[0m17:15:53.310311 [info ] [MainThread]: 
[0m17:15:53.311297 [info ] [MainThread]:   compiled code at target/compiled/sales_dbt_project/models/schema.yml/unique_fact_orders_order_key.sql
[0m17:15:53.312204 [info ] [MainThread]: 
[0m17:15:53.313037 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m17:15:53.314620 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.8515677, "process_in_blocks": "328", "process_kernel_time": 0.793956, "process_mem_max_rss": "116000", "process_out_blocks": "1600", "process_user_time": 2.644803}
[0m17:15:53.315586 [debug] [MainThread]: Command `dbt test` failed at 17:15:53.315485 after 5.85 seconds
[0m17:15:53.316414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652dad28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652e17c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b652d699490>]}
[0m17:15:53.317247 [debug] [MainThread]: Flushing usage events
[0m17:15:53.845423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:32.025904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206295a2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720629442f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206295a3c80>]}


============================== 17:16:32.033219 | 1b49910f-872a-40e8-a07e-ca8a8397937c ==============================
[0m17:16:32.033219 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:16:32.034539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:32.324016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206289e3c50>]}
[0m17:16:32.377527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720628abd280>]}
[0m17:16:32.379089 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:32.462909 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:16:32.709098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:32.710507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:32.744375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720627050110>]}
[0m17:16:32.817801 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:16:32.824361 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:16:32.854408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720627215c10>]}
[0m17:16:32.855525 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:16:32.856546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720626ef2870>]}
[0m17:16:32.859073 [info ] [MainThread]: 
[0m17:16:32.860226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:32.861254 [info ] [MainThread]: 
[0m17:16:32.862337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:32.866624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m17:16:32.937990 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m17:16:32.939456 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:16:32.940373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:32.984234 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m17:16:32.986524 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m17:16:32.988774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m17:16:32.994226 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:16:32.995553 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:16:32.996478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:33.002928 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.004261 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:16:33.005217 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:33.009188 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m17:16:33.011111 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:16:33.012252 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:16:33.018044 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.019271 [debug] [MainThread]: On master: BEGIN
[0m17:16:33.020159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:33.026341 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.027388 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.028305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:33.033237 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m17:16:33.036803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206271f0830>]}
[0m17:16:33.037714 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:33.038702 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.039579 [debug] [MainThread]: On master: BEGIN
[0m17:16:33.040730 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:33.041689 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.042578 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.043407 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.044362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:33.045169 [debug] [MainThread]: On master: Close
[0m17:16:33.047752 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m17:16:33.067569 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m17:16:33.068800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m17:16:33.069691 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m17:16:33.075152 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m17:16:33.082242 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m17:16:33.109818 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m17:16:33.117986 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.119038 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m17:16:33.119919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.135800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:16:33.136918 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.137788 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    postal_code || '-' || city AS region_key,
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m17:16:33.223021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.084 seconds
[0m17:16:33.229084 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.230017 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:16:33.232216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:33.235712 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.236736 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:16:33.237934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:33.250767 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:16:33.252029 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.253020 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m17:16:33.254991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.260881 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m17:16:33.267240 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m17:16:33.268297 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m17:16:33.272131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:16:33.275129 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m17:16:33.277997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720629582a20>]}
[0m17:16:33.279514 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m17:16:33.280873 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m17:16:33.282738 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m17:16:33.283784 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m17:16:33.284846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m17:16:33.285727 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m17:16:33.288601 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m17:16:33.295385 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m17:16:33.299015 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m17:16:33.306026 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:16:33.306944 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m17:16:33.307817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.314354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.315379 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:16:33.316218 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:16:33.318636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:33.321587 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:16:33.322515 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:16:33.323646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:33.325330 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:16:33.326184 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:16:33.327066 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m17:16:33.328583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.330807 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m17:16:33.331898 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m17:16:33.332767 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m17:16:33.334445 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:16:33.336119 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m17:16:33.337256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720624787da0>]}
[0m17:16:33.338464 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:16:33.339606 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m17:16:33.340494 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m17:16:33.341540 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m17:16:33.342734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m17:16:33.343739 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m17:16:33.346636 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m17:16:33.354383 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m17:16:33.358033 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m17:16:33.364968 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:16:33.365916 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m17:16:33.366851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.373230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.374206 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:16:33.375110 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m17:16:33.377788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:33.380910 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:16:33.381879 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m17:16:33.382989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:33.384741 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:16:33.385616 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:16:33.386456 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m17:16:33.387987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.390456 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m17:16:33.391566 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m17:16:33.392350 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m17:16:33.393475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:16:33.395894 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m17:16:33.396946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206247eb3e0>]}
[0m17:16:33.398030 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:16:33.399267 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m17:16:33.400231 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m17:16:33.401123 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m17:16:33.402084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m17:16:33.402978 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m17:16:33.405579 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m17:16:33.412619 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m17:16:33.416123 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m17:16:33.424014 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:16:33.424994 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m17:16:33.425911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.432435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.433518 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:16:33.434426 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_key || '-' || product_name AS product_key,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:16:33.436889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:33.440971 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:16:33.442012 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m17:16:33.443769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:33.445349 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m17:16:33.446715 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:16:33.447686 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m17:16:33.449243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.451742 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m17:16:33.452965 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m17:16:33.453931 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m17:16:33.455248 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:16:33.457135 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m17:16:33.458346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720624804f80>]}
[0m17:16:33.459825 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.06s]
[0m17:16:33.461011 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m17:16:33.461961 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m17:16:33.463003 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m17:16:33.464100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m17:16:33.464957 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m17:16:33.467692 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m17:16:33.474893 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m17:16:33.478986 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m17:16:33.486578 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:16:33.487598 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m17:16:33.488557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.494978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.496154 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:16:33.497063 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code,
    postal_code || '-' || city AS region_key
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m17:16:33.499689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:16:33.503118 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:16:33.503982 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m17:16:33.505173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:33.506713 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:16:33.507650 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:16:33.508458 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m17:16:33.509884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.512138 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m17:16:33.513573 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m17:16:33.514655 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m17:16:33.515643 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:16:33.517126 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m17:16:33.518051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720624804ec0>]}
[0m17:16:33.519168 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m17:16:33.520469 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m17:16:33.521921 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m17:16:33.522920 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m17:16:33.523986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m17:16:33.524793 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m17:16:33.528047 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m17:16:33.534695 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m17:16:33.538295 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m17:16:33.544973 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:16:33.545955 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m17:16:33.546860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:33.553511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:16:33.554860 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:16:33.555884 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_key,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_key = p.product_key
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region_key = r.region_key
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m17:16:33.595550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m17:16:33.600042 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:16:33.601192 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m17:16:33.602780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:33.604850 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m17:16:33.605971 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:16:33.606919 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m17:16:33.609332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:33.612031 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m17:16:33.613433 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m17:16:33.614377 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m17:16:33.615727 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:16:33.617759 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m17:16:33.619105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b49910f-872a-40e8-a07e-ca8a8397937c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206248175f0>]}
[0m17:16:33.620210 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m17:16:33.621444 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m17:16:33.623237 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.624009 [debug] [MainThread]: On master: BEGIN
[0m17:16:33.624735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:33.631004 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:16:33.631958 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.632704 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.633413 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.634366 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:33.635079 [debug] [MainThread]: On master: Close
[0m17:16:33.635947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:33.636662 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m17:16:33.637595 [info ] [MainThread]: 
[0m17:16:33.638551 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:16:33.640459 [debug] [MainThread]: Command end result
[0m17:16:33.672701 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:16:33.677556 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:16:33.686369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:16:33.687437 [info ] [MainThread]: 
[0m17:16:33.688527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:33.689443 [info ] [MainThread]: 
[0m17:16:33.690374 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:16:33.691891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7258941, "process_in_blocks": "8", "process_kernel_time": 0.784537, "process_mem_max_rss": "107584", "process_out_blocks": "1600", "process_user_time": 2.207768}
[0m17:16:33.693117 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:33.692983 after 1.73 seconds
[0m17:16:33.694085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720629167da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720628cb8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72062c1ee8d0>]}
[0m17:16:33.695125 [debug] [MainThread]: Flushing usage events
[0m17:16:34.501811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:42.430817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c118d5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c119cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11c32f00>]}


============================== 17:16:42.437867 | 57b741cb-8ff0-4a00-b50b-20d56a8c8a13 ==============================
[0m17:16:42.437867 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:16:42.439709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:42.639625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1218b050>]}
[0m17:16:42.691661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0fd606e0>]}
[0m17:16:42.693467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:42.776966 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:16:43.029800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:43.031028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:43.065022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11ca0230>]}
[0m17:16:43.139692 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:16:43.145773 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:16:43.193708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0f70ffb0>]}
[0m17:16:43.194849 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m17:16:43.195884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c119a0b30>]}
[0m17:16:43.198848 [info ] [MainThread]: 
[0m17:16:43.200372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:43.201606 [info ] [MainThread]: 
[0m17:16:43.202921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:43.207583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse_public'
[0m17:16:43.332400 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:16:43.333734 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m17:16:43.334510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:43.430204 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m17:16:43.431706 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m17:16:43.432606 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:43.436462 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m17:16:43.438396 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m17:16:43.439256 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m17:16:43.444798 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:43.445978 [debug] [MainThread]: On master: BEGIN
[0m17:16:43.447327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:43.569647 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m17:16:43.571324 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:43.572206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:43.576939 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m17:16:43.580323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57b741cb-8ff0-4a00-b50b-20d56a8c8a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0f72e6f0>]}
[0m17:16:43.581230 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:43.582264 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:43.583061 [debug] [MainThread]: On master: BEGIN
[0m17:16:43.584008 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:43.584738 [debug] [MainThread]: On master: COMMIT
[0m17:16:43.585429 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:43.586145 [debug] [MainThread]: On master: COMMIT
[0m17:16:43.586983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:43.587682 [debug] [MainThread]: On master: Close
[0m17:16:43.590085 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:16:43.591062 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m17:16:43.592122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc)
[0m17:16:43.592940 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:16:43.605687 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:16:43.612958 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:16:43.624580 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:16:43.631690 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:16:43.632545 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m17:16:43.633340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.683797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:16:43.685216 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"
[0m17:16:43.686369 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "sales_warehouse"."public"."dim_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m17:16:43.690580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:16:43.695087 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m17:16:43.696255 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc: Close
[0m17:16:43.697395 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.11s]
[0m17:16:43.698547 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc
[0m17:16:43.699456 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:16:43.700243 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_product_product_key ............................ [RUN]
[0m17:16:43.701270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_customer_customer_id.9775012dfc, now test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3)
[0m17:16:43.702160 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:16:43.705883 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:16:43.713107 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:16:43.716305 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:16:43.723204 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:16:43.724213 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: BEGIN
[0m17:16:43.725094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.731867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:16:43.732997 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"
[0m17:16:43.733808 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "sales_warehouse"."public"."dim_product"
where product_key is null



      
    ) dbt_internal_test
[0m17:16:43.738755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:16:43.740785 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: ROLLBACK
[0m17:16:43.741786 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3: Close
[0m17:16:43.742929 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_product_product_key .................................. [[32mPASS[0m in 0.04s]
[0m17:16:43.744102 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3
[0m17:16:43.745078 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:16:43.746021 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_region_region_key .............................. [RUN]
[0m17:16:43.747228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_product_product_key.f0e1d838d3, now test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def)
[0m17:16:43.748189 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:16:43.751876 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:16:43.759241 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:16:43.761607 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:16:43.768471 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:16:43.769550 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: BEGIN
[0m17:16:43.770449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.777290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:16:43.779058 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"
[0m17:16:43.780078 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region_key
from "sales_warehouse"."public"."dim_region"
where region_key is null



      
    ) dbt_internal_test
[0m17:16:43.783608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:16:43.785629 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: ROLLBACK
[0m17:16:43.786749 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def: Close
[0m17:16:43.787782 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_region_region_key .................................... [[32mPASS[0m in 0.04s]
[0m17:16:43.788840 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def
[0m17:16:43.789777 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:16:43.790629 [info ] [Thread-1 (]: 4 of 10 START test not_null_fact_orders_order_key .............................. [RUN]
[0m17:16:43.791643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_dim_region_region_key.9b2b3d9def, now test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4)
[0m17:16:43.792518 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:16:43.795901 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:16:43.802953 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:16:43.805296 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:16:43.812990 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:16:43.813927 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: BEGIN
[0m17:16:43.814758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.821105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:43.822272 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"
[0m17:16:43.823077 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "sales_warehouse"."public"."fact_orders"
where order_key is null



      
    ) dbt_internal_test
[0m17:16:43.827894 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:16:43.829978 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: ROLLBACK
[0m17:16:43.830960 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4: Close
[0m17:16:43.832092 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fact_orders_order_key .................................... [[32mPASS[0m in 0.04s]
[0m17:16:43.833266 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4
[0m17:16:43.834153 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:16:43.835021 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_orders_quantity ............................... [RUN]
[0m17:16:43.835990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_order_key.e893eb60e4, now test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18)
[0m17:16:43.836797 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:16:43.840413 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:16:43.847426 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:16:43.849738 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:16:43.856679 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:16:43.857689 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: BEGIN
[0m17:16:43.858731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.865758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:16:43.866780 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"
[0m17:16:43.867668 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantity
from "sales_warehouse"."public"."fact_orders"
where quantity is null



      
    ) dbt_internal_test
[0m17:16:43.873438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:16:43.875377 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: ROLLBACK
[0m17:16:43.876297 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18: Close
[0m17:16:43.877328 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_orders_quantity ..................................... [[32mPASS[0m in 0.04s]
[0m17:16:43.878667 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18
[0m17:16:43.879549 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:16:43.880373 [info ] [Thread-1 (]: 6 of 10 START test not_null_fact_orders_sales .................................. [RUN]
[0m17:16:43.881569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_quantity.7cea3edb18, now test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06)
[0m17:16:43.882529 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:16:43.886387 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:16:43.893305 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:16:43.895845 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:16:43.902964 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:16:43.903991 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: BEGIN
[0m17:16:43.904820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.911190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:43.912195 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"
[0m17:16:43.913102 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales
from "sales_warehouse"."public"."fact_orders"
where sales is null



      
    ) dbt_internal_test
[0m17:16:43.918757 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:16:43.920905 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: ROLLBACK
[0m17:16:43.921846 [debug] [Thread-1 (]: On test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06: Close
[0m17:16:43.922942 [info ] [Thread-1 (]: 6 of 10 PASS not_null_fact_orders_sales ........................................ [[32mPASS[0m in 0.04s]
[0m17:16:43.924080 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06
[0m17:16:43.925196 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:16:43.926188 [info ] [Thread-1 (]: 7 of 10 START test unique_dim_customer_customer_id ............................. [RUN]
[0m17:16:43.927190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.not_null_fact_orders_sales.2a46db7f06, now test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1)
[0m17:16:43.928237 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:16:43.933555 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:16:43.941206 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:16:43.943610 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:16:43.950313 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:16:43.951338 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m17:16:43.952250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.958458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:43.959660 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"
[0m17:16:43.960578 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:16:43.966455 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:16:43.969019 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m17:16:43.969948 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1: Close
[0m17:16:43.971086 [info ] [Thread-1 (]: 7 of 10 PASS unique_dim_customer_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m17:16:43.972268 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1
[0m17:16:43.973214 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:16:43.974019 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_product_product_key .............................. [RUN]
[0m17:16:43.975110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_customer_customer_id.b42affccd1, now test.sales_dbt_project.unique_dim_product_product_key.1753236bd0)
[0m17:16:43.976024 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:16:43.981287 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:16:43.988670 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:16:43.991171 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:16:43.997593 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:16:43.998437 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: BEGIN
[0m17:16:43.999240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:44.006055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:16:44.007183 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"
[0m17:16:44.008014 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_product"
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:16:44.017884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m17:16:44.019992 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: ROLLBACK
[0m17:16:44.021092 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_product_product_key.1753236bd0: Close
[0m17:16:44.022365 [info ] [Thread-1 (]: 8 of 10 PASS unique_dim_product_product_key .................................... [[32mPASS[0m in 0.05s]
[0m17:16:44.023501 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_product_product_key.1753236bd0
[0m17:16:44.024380 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:16:44.025248 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_region_region_key ................................ [RUN]
[0m17:16:44.026237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_product_product_key.1753236bd0, now test.sales_dbt_project.unique_dim_region_region_key.66a133323f)
[0m17:16:44.027133 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:16:44.030566 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:16:44.037613 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:16:44.040069 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:16:44.047043 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:16:44.048060 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: BEGIN
[0m17:16:44.048943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:44.055060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:44.056377 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"
[0m17:16:44.057307 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_dim_region_region_key.66a133323f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."dim_region"
where region_key is not null
group by region_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:16:44.065667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m17:16:44.067790 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: ROLLBACK
[0m17:16:44.068740 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_dim_region_region_key.66a133323f: Close
[0m17:16:44.069750 [info ] [Thread-1 (]: 9 of 10 PASS unique_dim_region_region_key ...................................... [[32mPASS[0m in 0.04s]
[0m17:16:44.070910 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_dim_region_region_key.66a133323f
[0m17:16:44.071829 [debug] [Thread-1 (]: Began running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:16:44.072625 [info ] [Thread-1 (]: 10 of 10 START test unique_fact_orders_order_key ............................... [RUN]
[0m17:16:44.073582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sales_dbt_project.unique_dim_region_region_key.66a133323f, now test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5)
[0m17:16:44.074364 [debug] [Thread-1 (]: Began compiling node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:16:44.077648 [debug] [Thread-1 (]: Writing injected SQL for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:16:44.084167 [debug] [Thread-1 (]: Began executing node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:16:44.086630 [debug] [Thread-1 (]: Writing runtime sql for node "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:16:44.093290 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:16:44.094194 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: BEGIN
[0m17:16:44.094997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:44.101569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:16:44.102853 [debug] [Thread-1 (]: Using postgres connection "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"
[0m17:16:44.103734 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from "sales_warehouse"."public"."fact_orders"
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m17:16:44.164368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.060 seconds
[0m17:16:44.166811 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: ROLLBACK
[0m17:16:44.168155 [debug] [Thread-1 (]: On test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5: Close
[0m17:16:44.169264 [info ] [Thread-1 (]: 10 of 10 PASS unique_fact_orders_order_key ..................................... [[32mPASS[0m in 0.10s]
[0m17:16:44.170432 [debug] [Thread-1 (]: Finished running node test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5
[0m17:16:44.172575 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:44.202735 [debug] [MainThread]: On master: BEGIN
[0m17:16:44.203689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:44.211449 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:16:44.212731 [debug] [MainThread]: On master: COMMIT
[0m17:16:44.213667 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:44.214583 [debug] [MainThread]: On master: COMMIT
[0m17:16:44.215709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:44.216668 [debug] [MainThread]: On master: Close
[0m17:16:44.217831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:44.218835 [debug] [MainThread]: Connection 'test.sales_dbt_project.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m17:16:44.219816 [info ] [MainThread]: 
[0m17:16:44.220822 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m17:16:44.223403 [debug] [MainThread]: Command end result
[0m17:16:44.253095 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m17:16:44.258206 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m17:16:44.268726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m17:16:44.269828 [info ] [MainThread]: 
[0m17:16:44.270952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:44.271917 [info ] [MainThread]: 
[0m17:16:44.272966 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:16:44.274578 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8997144, "process_in_blocks": "0", "process_kernel_time": 0.757838, "process_mem_max_rss": "110136", "process_out_blocks": "1600", "process_user_time": 2.500868}
[0m17:16:44.275696 [debug] [MainThread]: Command `dbt test` succeeded at 17:16:44.275589 after 1.90 seconds
[0m17:16:44.276586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c119cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c119cd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c11b52930>]}
[0m17:16:44.277567 [debug] [MainThread]: Flushing usage events
[0m17:16:44.811011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:18.559301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba626d89130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba625c3d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba625e18bc0>]}


============================== 15:12:18.615814 | 8fb56faf-43e1-4567-9e44-fe528a4a0d82 ==============================
[0m15:12:18.615814 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:12:18.617536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:19.786304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba624033dd0>]}
[0m15:12:19.881634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6258541a0>]}
[0m15:12:19.885116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:12:20.074075 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:12:23.264451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:23.266038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:23.301558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba623f5fef0>]}
[0m15:12:23.521035 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m15:12:23.649667 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m15:12:24.343479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba623c72510>]}
[0m15:12:24.344685 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m15:12:24.345700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba623cf5a60>]}
[0m15:12:24.348104 [info ] [MainThread]: 
[0m15:12:24.349247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:24.350183 [info ] [MainThread]: 
[0m15:12:24.351369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:24.355801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m15:12:27.010965 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m15:12:27.012146 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:12:27.013089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:28.845411 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.832 seconds
[0m15:12:28.848125 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m15:12:28.850883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m15:12:28.856493 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m15:12:28.857409 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m15:12:28.858201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:28.982888 [debug] [ThreadPool]: SQL status: BEGIN in 0.125 seconds
[0m15:12:29.048988 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m15:12:29.050130 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:12:30.246639 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.196 seconds
[0m15:12:30.249050 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m15:12:30.250155 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m15:12:30.256375 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:30.257512 [debug] [MainThread]: On master: BEGIN
[0m15:12:30.258510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:30.321143 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m15:12:30.357456 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:30.358420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:12:30.761638 [debug] [MainThread]: SQL status: SELECT 10 in 0.402 seconds
[0m15:12:30.765538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6275cc290>]}
[0m15:12:30.766578 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:30.767840 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:30.768815 [debug] [MainThread]: On master: BEGIN
[0m15:12:30.769953 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:12:30.770850 [debug] [MainThread]: On master: COMMIT
[0m15:12:30.771632 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:30.772359 [debug] [MainThread]: On master: COMMIT
[0m15:12:30.773877 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:12:30.774969 [debug] [MainThread]: On master: Close
[0m15:12:30.821883 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m15:12:30.849240 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m15:12:30.850421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m15:12:30.851368 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m15:12:30.856872 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m15:12:31.013418 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m15:12:31.045785 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m15:12:31.138532 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:31.139647 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m15:12:31.140685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:31.216580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m15:12:31.218012 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:31.218980 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    postal_code || '-' || city AS region_key,
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m15:12:32.451387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.231 seconds
[0m15:12:32.457737 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:32.459091 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:12:32.554958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m15:12:32.558397 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:32.559368 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:12:32.560921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:32.574005 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m15:12:32.575245 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:32.576135 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m15:12:32.577947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:32.583871 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m15:12:32.589853 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m15:12:32.590953 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m15:12:32.920033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.328 seconds
[0m15:12:32.923822 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m15:12:32.926780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6275222d0>]}
[0m15:12:32.928197 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 2.07s]
[0m15:12:32.929430 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m15:12:32.931094 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m15:12:32.932137 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m15:12:32.933162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m15:12:32.933957 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m15:12:32.936739 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m15:12:33.023177 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m15:12:33.026944 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m15:12:33.061435 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m15:12:33.079260 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m15:12:33.080599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:33.150774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m15:12:33.151939 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m15:12:33.152806 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m15:12:33.183334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m15:12:33.186762 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m15:12:33.187751 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m15:12:33.189128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:12:33.190661 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m15:12:33.191628 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m15:12:33.192561 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m15:12:33.194821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:33.197241 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m15:12:33.198354 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m15:12:33.199130 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m15:12:33.200572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:12:33.202206 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m15:12:33.203259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba622efbce0>]}
[0m15:12:33.204396 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m15:12:33.205505 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m15:12:33.206338 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m15:12:33.207230 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m15:12:33.208124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m15:12:33.208999 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m15:12:33.211649 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m15:12:33.225926 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m15:12:33.229122 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m15:12:33.286853 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m15:12:33.287903 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m15:12:33.288815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:33.306623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:12:33.307857 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m15:12:33.308849 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m15:12:33.332169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m15:12:33.335402 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m15:12:33.336375 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:12:33.337806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:12:33.339398 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m15:12:33.340336 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m15:12:33.341257 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m15:12:33.342839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:33.346383 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m15:12:33.347667 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m15:12:33.348484 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m15:12:33.349759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:12:33.351335 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m15:12:33.352413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba621520ec0>]}
[0m15:12:33.353428 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:12:33.354478 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m15:12:33.355366 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m15:12:33.356371 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m15:12:33.357358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m15:12:33.358235 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m15:12:33.360857 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m15:12:33.454591 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m15:12:33.457738 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m15:12:33.817550 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m15:12:33.818861 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m15:12:33.820088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:33.861320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m15:12:33.862731 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m15:12:33.863742 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_key || '-' || product_name AS product_key,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m15:12:33.866685 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:12:33.870031 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m15:12:33.871053 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m15:12:33.872291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:12:33.873867 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m15:12:33.874760 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m15:12:33.875651 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m15:12:33.878028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:12:33.880257 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m15:12:33.881314 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m15:12:33.882136 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m15:12:33.883199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:12:33.884758 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m15:12:33.885838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba623c6ec00>]}
[0m15:12:33.886833 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.53s]
[0m15:12:33.887937 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m15:12:33.888948 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m15:12:33.889937 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m15:12:33.890857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m15:12:33.891611 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m15:12:33.894191 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m15:12:33.936686 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m15:12:33.939924 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m15:12:33.976384 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m15:12:33.977423 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m15:12:33.978381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:33.984951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:12:33.986115 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m15:12:33.986933 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code,
    postal_code || '-' || city AS region_key
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m15:12:33.989473 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:12:33.992376 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m15:12:33.993298 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m15:12:34.003372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:12:34.005388 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m15:12:34.006231 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m15:12:34.007108 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m15:12:34.008600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:34.010818 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m15:12:34.011942 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m15:12:34.012939 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m15:12:34.014141 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:12:34.015606 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m15:12:34.016588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6275222d0>]}
[0m15:12:34.017691 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:12:34.018794 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m15:12:34.020065 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m15:12:34.020936 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m15:12:34.021857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m15:12:34.022667 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m15:12:34.025946 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m15:12:34.120180 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m15:12:34.123703 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m15:12:34.159285 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m15:12:34.160208 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m15:12:34.161202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:34.167974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:12:34.169057 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m15:12:34.169856 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_key,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_key = p.product_key
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region_key = r.region_key
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m15:12:34.203594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:12:34.208034 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m15:12:34.208961 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m15:12:34.210317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:12:34.211889 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m15:12:34.213080 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m15:12:34.214088 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m15:12:34.237714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m15:12:34.240413 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m15:12:34.241461 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m15:12:34.242312 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m15:12:34.243437 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:12:34.245095 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m15:12:34.246118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb56faf-43e1-4567-9e44-fe528a4a0d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba62153fda0>]}
[0m15:12:34.247134 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m15:12:34.248265 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m15:12:34.250103 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.250891 [debug] [MainThread]: On master: BEGIN
[0m15:12:34.251636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:34.364435 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m15:12:34.365587 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.366529 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:34.367513 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.368714 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:34.369586 [debug] [MainThread]: On master: Close
[0m15:12:34.370627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:34.371486 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m15:12:34.372546 [info ] [MainThread]: 
[0m15:12:34.373407 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m15:12:34.375316 [debug] [MainThread]: Command end result
[0m15:12:34.406156 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m15:12:34.411196 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m15:12:34.545073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m15:12:34.546198 [info ] [MainThread]: 
[0m15:12:34.547283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:34.548266 [info ] [MainThread]: 
[0m15:12:34.549320 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:12:34.574565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.028147, "process_in_blocks": "101312", "process_kernel_time": 16.571589, "process_mem_max_rss": "105732", "process_out_blocks": "0", "process_user_time": 5.494145}
[0m15:12:34.576275 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:34.576151 after 21.03 seconds
[0m15:12:34.577369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba6263f7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba626310b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba625dd8e60>]}
[0m15:12:34.578501 [debug] [MainThread]: Flushing usage events
[0m15:12:35.481031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:58.891146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace5964f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace53725a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace52a4bc0>]}


============================== 08:47:58.897207 | 7b01c787-dd55-4fc6-a6b9-1c31f0b6a366 ==============================
[0m08:47:58.897207 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:47:58.898705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:47:59.136387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace50e4e00>]}
[0m08:47:59.192058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace4fe76e0>]}
[0m08:47:59.193946 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:47:59.297677 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:48:00.096476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:00.098024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:00.143400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace3799400>]}
[0m08:48:00.270166 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m08:48:00.289052 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m08:48:00.355501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace3596c30>]}
[0m08:48:00.356807 [info ] [MainThread]: Found 6 models, 10 data tests, 429 macros
[0m08:48:00.357828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace384c3b0>]}
[0m08:48:00.360659 [info ] [MainThread]: 
[0m08:48:00.361980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:00.363141 [info ] [MainThread]: 
[0m08:48:00.364467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:48:00.369770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_warehouse'
[0m08:48:00.447274 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse"
[0m08:48:00.448687 [debug] [ThreadPool]: On list_sales_warehouse: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m08:48:00.449732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:00.511980 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m08:48:00.514428 [debug] [ThreadPool]: On list_sales_warehouse: Close
[0m08:48:00.517821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_warehouse, now list_sales_warehouse_public)
[0m08:48:00.524121 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m08:48:00.525416 [debug] [ThreadPool]: On list_sales_warehouse_public: BEGIN
[0m08:48:00.526550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:00.535360 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:48:00.536671 [debug] [ThreadPool]: Using postgres connection "list_sales_warehouse_public"
[0m08:48:00.537666 [debug] [ThreadPool]: On list_sales_warehouse_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_sales_warehouse_public"} */
select
      'sales_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:48:00.553671 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m08:48:00.555902 [debug] [ThreadPool]: On list_sales_warehouse_public: ROLLBACK
[0m08:48:00.557190 [debug] [ThreadPool]: On list_sales_warehouse_public: Close
[0m08:48:00.563589 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:00.565020 [debug] [MainThread]: On master: BEGIN
[0m08:48:00.566108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:48:00.573556 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:48:00.575292 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:00.576519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:48:00.588563 [debug] [MainThread]: SQL status: SELECT 10 in 0.011 seconds
[0m08:48:00.592686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace33f8170>]}
[0m08:48:00.593895 [debug] [MainThread]: On master: ROLLBACK
[0m08:48:00.595235 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:00.596161 [debug] [MainThread]: On master: BEGIN
[0m08:48:00.597413 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:48:00.598292 [debug] [MainThread]: On master: COMMIT
[0m08:48:00.599109 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:00.599907 [debug] [MainThread]: On master: COMMIT
[0m08:48:00.601032 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:48:00.601925 [debug] [MainThread]: On master: Close
[0m08:48:00.604690 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.stg_orders
[0m08:48:00.606095 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_orders .................................. [RUN]
[0m08:48:00.607253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_warehouse_public, now model.sales_dbt_project.stg_orders)
[0m08:48:00.608104 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.stg_orders
[0m08:48:00.614407 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.stg_orders"
[0m08:48:00.632709 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.stg_orders
[0m08:48:00.663111 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.stg_orders"
[0m08:48:00.679020 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.680187 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: BEGIN
[0m08:48:00.681105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:00.688275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:48:00.689387 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.690324 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */

  create view "sales_warehouse"."public"."stg_orders__dbt_tmp"
    
    
  as (
    -- Standardisation et typage correct des donn√©es brutes
SELECT
    CAST(Row_ID AS INTEGER) AS row_id,
    Order_ID AS order_id,
    CAST(Order_Date AS DATE) AS order_date,
    CAST(Ship_Date AS DATE) AS ship_date,
    Ship_Mode AS ship_mode,
    Customer_ID AS customer_id,
    Customer_Name AS customer_name,
    Segment AS segment,
    Country AS country,
    City AS city,
    State AS state,
    Postal_Code AS postal_code,  -- garder TEXT car certains codes postaux peuvent commencer par 0
    postal_code || '-' || city AS region_key,
    Region AS region,
    product_id || '-' || product_name AS product_key,
    Category AS category,
    Sub_Category AS sub_category,
    Product_Name AS product_name,
    CAST(Sales AS NUMERIC(10,2)) AS sales,
    CAST(Quantity AS INTEGER) AS quantity,
    CAST(Discount AS NUMERIC(5,2)) AS discount,
    CAST(Profit AS NUMERIC(10,2)) AS profit
FROM public.sales
  );
[0m08:48:00.707578 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m08:48:00.713898 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.714951 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m08:48:00.716300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:48:00.720189 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.721393 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
alter table "sales_warehouse"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m08:48:00.723081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:48:00.737683 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m08:48:00.738936 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.739882 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: COMMIT
[0m08:48:00.741546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:00.748033 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."stg_orders__dbt_backup"
[0m08:48:00.754958 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.stg_orders"
[0m08:48:00.756364 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.stg_orders"} */
drop view if exists "sales_warehouse"."public"."stg_orders__dbt_backup" cascade
[0m08:48:00.764229 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m08:48:00.767752 [debug] [Thread-1 (]: On model.sales_dbt_project.stg_orders: Close
[0m08:48:00.770733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace3864320>]}
[0m08:48:00.772385 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m08:48:00.773735 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.stg_orders
[0m08:48:00.775444 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_customer
[0m08:48:00.776715 [info ] [Thread-1 (]: 2 of 6 START sql view model public.dim_customer ................................ [RUN]
[0m08:48:00.777930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.stg_orders, now model.sales_dbt_project.dim_customer)
[0m08:48:00.778929 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_customer
[0m08:48:00.782193 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_customer"
[0m08:48:00.798471 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_customer
[0m08:48:00.802198 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_customer"
[0m08:48:00.819054 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m08:48:00.820226 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: BEGIN
[0m08:48:00.821259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:00.828230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:48:00.829686 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m08:48:00.830734 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */

  create view "sales_warehouse"."public"."dim_customer__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m08:48:00.833869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:48:00.837902 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m08:48:00.839272 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
alter table "sales_warehouse"."public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m08:48:00.840855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:48:00.842843 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m08:48:00.844824 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m08:48:00.846263 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: COMMIT
[0m08:48:00.848398 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:00.851515 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_customer__dbt_backup"
[0m08:48:00.853017 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_customer"
[0m08:48:00.854277 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_customer"} */
drop view if exists "sales_warehouse"."public"."dim_customer__dbt_backup" cascade
[0m08:48:00.855979 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:48:00.858181 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_customer: Close
[0m08:48:00.859859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace27feae0>]}
[0m08:48:00.861464 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.dim_customer ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:48:00.863074 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_customer
[0m08:48:00.864292 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_date
[0m08:48:00.865426 [info ] [Thread-1 (]: 3 of 6 START sql view model public.dim_date .................................... [RUN]
[0m08:48:00.866626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_customer, now model.sales_dbt_project.dim_date)
[0m08:48:00.867767 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_date
[0m08:48:00.870832 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_date"
[0m08:48:00.887935 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_date
[0m08:48:00.892067 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_date"
[0m08:48:00.910654 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m08:48:00.912318 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: BEGIN
[0m08:48:00.913465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:00.920786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:48:00.922190 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m08:48:00.923307 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */

  create view "sales_warehouse"."public"."dim_date__dbt_tmp"
    
    
  as (
    -- On cr√©e une table de dates √† partir des dates de commandes
SELECT DISTINCT
    order_date AS date_id,
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    EXTRACT(DAY FROM order_date) AS day
FROM "sales_warehouse"."public"."stg_orders"
WHERE order_date IS NOT NULL
  );
[0m08:48:00.929103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:48:00.932950 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m08:48:00.934109 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
alter table "sales_warehouse"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:48:00.935561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:48:00.937494 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m08:48:00.938589 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m08:48:00.939514 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: COMMIT
[0m08:48:00.941445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:00.945464 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_date__dbt_backup"
[0m08:48:00.947218 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_date"
[0m08:48:00.948268 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_date"} */
drop view if exists "sales_warehouse"."public"."dim_date__dbt_backup" cascade
[0m08:48:00.949467 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:48:00.951417 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_date: Close
[0m08:48:00.952908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace0e49610>]}
[0m08:48:00.954352 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.dim_date ............................... [[32mCREATE VIEW[0m in 0.09s]
[0m08:48:00.955724 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_date
[0m08:48:00.956856 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_product
[0m08:48:00.958288 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_product ................................. [RUN]
[0m08:48:00.959438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_date, now model.sales_dbt_project.dim_product)
[0m08:48:00.960444 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_product
[0m08:48:00.963709 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_product"
[0m08:48:00.979536 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_product
[0m08:48:00.983317 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_product"
[0m08:48:00.999243 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m08:48:01.000311 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: BEGIN
[0m08:48:01.001265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:01.008065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:48:01.009259 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m08:48:01.010164 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */

  create view "sales_warehouse"."public"."dim_product__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    product_key || '-' || product_name AS product_key,
    category,
    sub_category,
    product_name
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m08:48:01.012799 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:48:01.016030 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m08:48:01.017041 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
alter table "sales_warehouse"."public"."dim_product__dbt_tmp" rename to "dim_product"
[0m08:48:01.018364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:48:01.020312 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m08:48:01.021158 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m08:48:01.021941 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: COMMIT
[0m08:48:01.023592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:01.026073 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_product__dbt_backup"
[0m08:48:01.027318 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_product"
[0m08:48:01.028226 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_product"} */
drop view if exists "sales_warehouse"."public"."dim_product__dbt_backup" cascade
[0m08:48:01.029549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:48:01.031357 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_product: Close
[0m08:48:01.032454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace0e3a0c0>]}
[0m08:48:01.033672 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_product ............................ [[32mCREATE VIEW[0m in 0.07s]
[0m08:48:01.035084 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_product
[0m08:48:01.036088 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.dim_region
[0m08:48:01.037216 [info ] [Thread-1 (]: 5 of 6 START sql view model public.dim_region .................................. [RUN]
[0m08:48:01.038406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_product, now model.sales_dbt_project.dim_region)
[0m08:48:01.039393 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.dim_region
[0m08:48:01.042394 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.dim_region"
[0m08:48:01.058275 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.dim_region
[0m08:48:01.061672 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.dim_region"
[0m08:48:01.078818 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m08:48:01.079999 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: BEGIN
[0m08:48:01.080997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:01.087738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:48:01.088996 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m08:48:01.089913 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */

  create view "sales_warehouse"."public"."dim_region__dbt_tmp"
    
    
  as (
    SELECT DISTINCT
    region,
    country,
    state,
    city,
    postal_code,
    postal_code || '-' || city AS region_key
FROM "sales_warehouse"."public"."stg_orders"
  );
[0m08:48:01.093020 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:48:01.096902 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m08:48:01.098290 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
alter table "sales_warehouse"."public"."dim_region__dbt_tmp" rename to "dim_region"
[0m08:48:01.099650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:48:01.101494 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m08:48:01.102530 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m08:48:01.103376 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: COMMIT
[0m08:48:01.105250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:01.107970 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."dim_region__dbt_backup"
[0m08:48:01.109236 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.dim_region"
[0m08:48:01.110117 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.dim_region"} */
drop view if exists "sales_warehouse"."public"."dim_region__dbt_backup" cascade
[0m08:48:01.111456 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:48:01.113630 [debug] [Thread-1 (]: On model.sales_dbt_project.dim_region: Close
[0m08:48:01.115410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace2749040>]}
[0m08:48:01.116988 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.dim_region ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m08:48:01.118602 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.dim_region
[0m08:48:01.120188 [debug] [Thread-1 (]: Began running node model.sales_dbt_project.fact_orders
[0m08:48:01.121531 [info ] [Thread-1 (]: 6 of 6 START sql view model public.fact_orders ................................. [RUN]
[0m08:48:01.122651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sales_dbt_project.dim_region, now model.sales_dbt_project.fact_orders)
[0m08:48:01.123639 [debug] [Thread-1 (]: Began compiling node model.sales_dbt_project.fact_orders
[0m08:48:01.127580 [debug] [Thread-1 (]: Writing injected SQL for node "model.sales_dbt_project.fact_orders"
[0m08:48:01.143378 [debug] [Thread-1 (]: Began executing node model.sales_dbt_project.fact_orders
[0m08:48:01.147697 [debug] [Thread-1 (]: Writing runtime sql for node "model.sales_dbt_project.fact_orders"
[0m08:48:01.166096 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m08:48:01.167600 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: BEGIN
[0m08:48:01.168847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:01.177608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:48:01.179148 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m08:48:01.180549 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */

  create view "sales_warehouse"."public"."fact_orders__dbt_tmp"
    
    
  as (
    SELECT
    o.row_id AS order_key,
    c.customer_id,
    p.product_key,
    r.region,
    d.date_id AS order_date,
    o.sales,
    o.quantity,
    o.discount,
    o.profit
FROM "sales_warehouse"."public"."stg_orders" o
LEFT JOIN "sales_warehouse"."public"."dim_customer" c ON o.customer_id = c.customer_id
LEFT JOIN "sales_warehouse"."public"."dim_product" p ON o.product_key = p.product_key
LEFT JOIN "sales_warehouse"."public"."dim_region" r ON o.region_key = r.region_key
LEFT JOIN "sales_warehouse"."public"."dim_date" d ON o.order_date = d.date_id
  );
[0m08:48:01.186686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:48:01.193836 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m08:48:01.195320 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
alter table "sales_warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m08:48:01.196932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:48:01.199422 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m08:48:01.200809 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m08:48:01.202053 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: COMMIT
[0m08:48:01.204249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:48:01.207817 [debug] [Thread-1 (]: Applying DROP to: "sales_warehouse"."public"."fact_orders__dbt_backup"
[0m08:48:01.209761 [debug] [Thread-1 (]: Using postgres connection "model.sales_dbt_project.fact_orders"
[0m08:48:01.211180 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.sales_dbt_project.fact_orders"} */
drop view if exists "sales_warehouse"."public"."fact_orders__dbt_backup" cascade
[0m08:48:01.212832 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:48:01.215454 [debug] [Thread-1 (]: On model.sales_dbt_project.fact_orders: Close
[0m08:48:01.217158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c787-dd55-4fc6-a6b9-1c31f0b6a366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace0e67c80>]}
[0m08:48:01.218513 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.fact_orders ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m08:48:01.222539 [debug] [Thread-1 (]: Finished running node model.sales_dbt_project.fact_orders
[0m08:48:01.224810 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:01.225924 [debug] [MainThread]: On master: BEGIN
[0m08:48:01.226794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:48:01.233720 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:48:01.235282 [debug] [MainThread]: On master: COMMIT
[0m08:48:01.236281 [debug] [MainThread]: Using postgres connection "master"
[0m08:48:01.237304 [debug] [MainThread]: On master: COMMIT
[0m08:48:01.238471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:48:01.239566 [debug] [MainThread]: On master: Close
[0m08:48:01.240666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:01.241586 [debug] [MainThread]: Connection 'model.sales_dbt_project.fact_orders' was properly closed.
[0m08:48:01.242811 [info ] [MainThread]: 
[0m08:48:01.244325 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m08:48:01.246415 [debug] [MainThread]: Command end result
[0m08:48:01.280290 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m08:48:01.287261 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m08:48:01.312358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m08:48:01.313740 [info ] [MainThread]: 
[0m08:48:01.315165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:01.316430 [info ] [MainThread]: 
[0m08:48:01.317530 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:48:01.320442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6493728, "process_in_blocks": "110928", "process_kernel_time": 0.729624, "process_mem_max_rss": "106000", "process_out_blocks": "0", "process_user_time": 2.213605}
[0m08:48:01.322124 [debug] [MainThread]: Command `dbt run` succeeded at 08:48:01.321930 after 2.65 seconds
[0m08:48:01.323380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace51a39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace500bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70ace5a65b50>]}
[0m08:48:01.324614 [debug] [MainThread]: Flushing usage events
[0m08:48:02.249404 [debug] [MainThread]: An error was encountered while trying to flush usage events
